<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4.5 Decision Boundaries | R Code Companion for the Textbook Introduction to Data Mining" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This book contains documented R examples to accompany several chapters of the popular data mining text book Introduction to Data Mining by Pang-Ning Tan, Michael Steinbach and Vipin Kumar (2006 or 2017 edition)." />


<meta name="author" content="Michael Hahsler" />

<meta name="date" content="2021-07-09" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="This book contains documented R examples to accompany several chapters of the popular data mining text book Introduction to Data Mining by Pang-Ning Tan, Michael Steinbach and Vipin Kumar (2006 or 2017 edition).">

<title>4.5 Decision Boundaries | R Code Companion for the Textbook Introduction to Data Mining</title>

<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap/js/bootstrap.min.js"></script>
<script src="libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation/tabsets.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider/jquery.nouislider.min.js"></script>
<link href="libs/selectize/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize/selectize.min.js"></script>
<link href="libs/vis/vis.css" rel="stylesheet" />
<script src="libs/vis/vis.min.js"></script>
<script src="libs/visNetwork-binding/visNetwork.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface">Preface</a></li>
<li><a href="1-introduction.html#introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="1-1-data-manipulation-with-tidyverse.html#data-manipulation-with-tidyverse"><span class="toc-section-number">1.1</span> Data Manipulation with Tidyverse</a></li>
<li><a href="1-2-visualization-with-ggplot2.html#visualization-with-ggplot2"><span class="toc-section-number">1.2</span> Visualization with ggplot2</a></li>
</ul></li>
<li><a href="2-data.html#data"><span class="toc-section-number">2</span> Data</a>
<ul>
<li><a href="2-1-the-iris-dataset.html#the-iris-dataset"><span class="toc-section-number">2.1</span> The Iris Dataset</a></li>
<li><a href="2-2-data-quality.html#data-quality"><span class="toc-section-number">2.2</span> Data Quality</a></li>
<li><a href="2-3-aggregation.html#aggregation"><span class="toc-section-number">2.3</span> Aggregation</a></li>
<li><a href="2-4-sampling.html#sampling"><span class="toc-section-number">2.4</span> Sampling</a>
<ul>
<li><a href="2-4-sampling.html#random-sampling"><span class="toc-section-number">2.4.1</span> Random Sampling</a></li>
<li><a href="2-4-sampling.html#stratified-sampling"><span class="toc-section-number">2.4.2</span> Stratified Sampling</a></li>
</ul></li>
<li><a href="2-5-features.html#features"><span class="toc-section-number">2.5</span> Features</a>
<ul>
<li><a href="2-5-features.html#dimensionality-reduction"><span class="toc-section-number">2.5.1</span> Dimensionality Reduction</a></li>
<li><a href="2-5-features.html#feature-selection"><span class="toc-section-number">2.5.2</span> Feature Selection</a></li>
<li><a href="2-5-features.html#discretize-features"><span class="toc-section-number">2.5.3</span> Discretize Features</a></li>
<li><a href="2-5-features.html#standardize-data-z-scores"><span class="toc-section-number">2.5.4</span> Standardize Data (Z-Scores)</a></li>
</ul></li>
<li><a href="2-6-proximities-similarities-and-distances.html#proximities-similarities-and-distances"><span class="toc-section-number">2.6</span> Proximities: Similarities and Distances</a>
<ul>
<li><a href="2-6-proximities-similarities-and-distances.html#minkowsky-distances"><span class="toc-section-number">2.6.1</span> Minkowsky Distances</a></li>
<li><a href="2-6-proximities-similarities-and-distances.html#distances-for-binary-data"><span class="toc-section-number">2.6.2</span> Distances for Binary Data</a></li>
<li><a href="2-6-proximities-similarities-and-distances.html#distances-for-mixed-data"><span class="toc-section-number">2.6.3</span> Distances for Mixed Data</a></li>
<li><a href="2-6-proximities-similarities-and-distances.html#additional-proximity-measures-available-in-package-proxy"><span class="toc-section-number">2.6.4</span> Additional proximity Measures Available in Package proxy</a></li>
</ul></li>
<li><a href="2-7-relationships-between-features.html#relationships-between-features"><span class="toc-section-number">2.7</span> Relationships Between Features</a>
<ul>
<li><a href="2-7-relationships-between-features.html#correlation"><span class="toc-section-number">2.7.1</span> Correlation</a></li>
<li><a href="2-7-relationships-between-features.html#rank-correlation"><span class="toc-section-number">2.7.2</span> Rank Correlation</a></li>
<li><a href="2-7-relationships-between-features.html#relationship-between-nominal-and-ordinal-features"><span class="toc-section-number">2.7.3</span> Relationship Between Nominal and Ordinal Features</a></li>
</ul></li>
<li><a href="2-8-density-estimation.html#density-estimation"><span class="toc-section-number">2.8</span> Density Estimation</a></li>
<li><a href="2-9-exploring-data.html#exploring-data"><span class="toc-section-number">2.9</span> Exploring Data</a>
<ul>
<li><a href="2-9-exploring-data.html#basic-statistics"><span class="toc-section-number">2.9.1</span> Basic statistics</a></li>
<li><a href="2-9-exploring-data.html#tabulate-data"><span class="toc-section-number">2.9.2</span> Tabulate data</a></li>
<li><a href="2-9-exploring-data.html#percentiles-quantiles"><span class="toc-section-number">2.9.3</span> Percentiles (Quantiles)</a></li>
</ul></li>
<li><a href="2-10-visualization.html#visualization"><span class="toc-section-number">2.10</span> Visualization</a>
<ul>
<li><a href="2-10-visualization.html#histogram"><span class="toc-section-number">2.10.1</span> Histogram</a></li>
<li><a href="2-10-visualization.html#boxplot"><span class="toc-section-number">2.10.2</span> Boxplot</a></li>
<li><a href="2-10-visualization.html#scatter-plot"><span class="toc-section-number">2.10.3</span> Scatter plot</a></li>
<li><a href="2-10-visualization.html#scatter-plot-matrix"><span class="toc-section-number">2.10.4</span> Scatter Plot Matrix</a></li>
<li><a href="2-10-visualization.html#data-matrix-visualization"><span class="toc-section-number">2.10.5</span> Data Matrix Visualization</a></li>
<li><a href="2-10-visualization.html#correlation-matrix"><span class="toc-section-number">2.10.6</span> Correlation Matrix</a></li>
<li><a href="2-10-visualization.html#parallel-coordinates-plot"><span class="toc-section-number">2.10.7</span> Parallel Coordinates Plot</a></li>
</ul></li>
</ul></li>
<li><a href="3-classification-basic-concepts-and-techniques.html#classification-basic-concepts-and-techniques"><span class="toc-section-number">3</span> Classification: Basic Concepts and Techniques</a>
<ul>
<li><a href="3-1-the-zoo-dataset.html#the-zoo-dataset"><span class="toc-section-number">3.1</span> The Zoo Dataset</a></li>
<li><a href="3-2-decision-trees.html#decision-trees"><span class="toc-section-number">3.2</span> Decision Trees</a>
<ul>
<li><a href="3-2-decision-trees.html#create-tree-with-default-settings-uses-pre-pruning"><span class="toc-section-number">3.2.1</span> Create Tree With Default Settings (uses pre-pruning)</a></li>
<li><a href="3-2-decision-trees.html#create-a-full-tree"><span class="toc-section-number">3.2.2</span> Create a Full Tree</a></li>
<li><a href="3-2-decision-trees.html#make-predictions-for-new-data"><span class="toc-section-number">3.2.3</span> Make Predictions for New Data</a></li>
</ul></li>
<li><a href="3-3-model-evaluation-with-caret.html#model-evaluation-with-caret"><span class="toc-section-number">3.3</span> Model Evaluation with Caret</a>
<ul>
<li><a href="3-3-model-evaluation-with-caret.html#hold-out-test-data"><span class="toc-section-number">3.3.1</span> Hold out Test Data</a></li>
<li><a href="3-3-model-evaluation-with-caret.html#learn-a-model-and-tune-hyperparameters-on-the-training-data"><span class="toc-section-number">3.3.2</span> Learn a Model and Tune Hyperparameters on the Training Data</a></li>
</ul></li>
<li><a href="3-4-testing-confusion-matrix-and-confidence-interval-for-accuracy.html#testing-confusion-matrix-and-confidence-interval-for-accuracy"><span class="toc-section-number">3.4</span> Testing: Confusion Matrix and Confidence Interval for Accuracy</a></li>
<li><a href="3-5-model-comparison.html#model-comparison"><span class="toc-section-number">3.5</span> Model Comparison</a></li>
<li><a href="3-6-feature-selection-and-feature-preparation.html#feature-selection-and-feature-preparation"><span class="toc-section-number">3.6</span> Feature Selection and Feature Preparation</a>
<ul>
<li><a href="3-6-feature-selection-and-feature-preparation.html#univariate-feature-importance-score"><span class="toc-section-number">3.6.1</span> Univariate Feature Importance Score</a></li>
<li><a href="3-6-feature-selection-and-feature-preparation.html#feature-subset-selection"><span class="toc-section-number">3.6.2</span> Feature Subset Selection</a></li>
<li><a href="3-6-feature-selection-and-feature-preparation.html#using-dummy-variables-for-factors"><span class="toc-section-number">3.6.3</span> Using Dummy Variables for Factors</a></li>
</ul></li>
<li><a href="3-7-class-imbalance.html#class-imbalance"><span class="toc-section-number">3.7</span> Class Imbalance</a>
<ul>
<li><a href="3-7-class-imbalance.html#option-1-use-the-data-as-is-and-hope-for-the-best"><span class="toc-section-number">3.7.1</span> Option 1: Use the Data As Is and Hope For The Best</a></li>
<li><a href="3-7-class-imbalance.html#option-2-balance-data-with-resampling"><span class="toc-section-number">3.7.2</span> Option 2: Balance Data With Resampling</a></li>
<li><a href="3-7-class-imbalance.html#option-3-build-a-larger-tree-and-use-predicted-probabilities"><span class="toc-section-number">3.7.3</span> Option 3: Build A Larger Tree and use Predicted Probabilities</a></li>
<li><a href="3-7-class-imbalance.html#option-4-use-a-cost-sensitive-classifier"><span class="toc-section-number">3.7.4</span> Option 4: Use a Cost-Sensitive Classifier</a></li>
</ul></li>
</ul></li>
<li><a href="4-classification-alternative-techniques.html#classification-alternative-techniques"><span class="toc-section-number">4</span> Classification: Alternative Techniques</a>
<ul>
<li><a href="4-1-training-and-test-data.html#training-and-test-data"><span class="toc-section-number">4.1</span> Training and Test Data</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#fitting-different-classification-models-to-the-training-data"><span class="toc-section-number">4.2</span> Fitting Different Classification Models to the Training Data</a>
<ul>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#conditional-inference-tree-decision-tree"><span class="toc-section-number">4.2.1</span> Conditional Inference Tree (Decision Tree)</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#c-4.5-decision-tree"><span class="toc-section-number">4.2.2</span> C 4.5 Decision Tree</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#k-nearest-neighbors"><span class="toc-section-number">4.2.3</span> K-Nearest Neighbors</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#part-rule-based-classifier"><span class="toc-section-number">4.2.4</span> PART (Rule-based classifier)</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#linear-support-vector-machines"><span class="toc-section-number">4.2.5</span> Linear Support Vector Machines</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#random-forest"><span class="toc-section-number">4.2.6</span> Random Forest</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#gradient-boosted-decision-trees-xgboost"><span class="toc-section-number">4.2.7</span> Gradient Boosted Decision Trees (xgboost)</a></li>
<li><a href="4-2-fitting-different-classification-models-to-the-training-data.html#artificial-neural-network"><span class="toc-section-number">4.2.8</span> Artificial Neural Network</a></li>
</ul></li>
<li><a href="4-3-comparing-models.html#comparing-models"><span class="toc-section-number">4.3</span> Comparing Models</a></li>
<li><a href="4-4-applying-the-chosen-model-to-the-test-data.html#applying-the-chosen-model-to-the-test-data"><span class="toc-section-number">4.4</span> Applying the Chosen Model to the Test Data</a></li>
<li><a href="4-5-decision-boundaries.html#decision-boundaries"><span class="toc-section-number">4.5</span> Decision Boundaries</a>
<ul>
<li><a href="4-5-decision-boundaries.html#iris-dataset"><span class="toc-section-number">4.5.1</span> Iris Dataset</a></li>
<li><a href="4-5-decision-boundaries.html#circle-dataset"><span class="toc-section-number">4.5.2</span> Circle Dataset</a></li>
</ul></li>
<li><a href="4-6-more-information.html#more-information"><span class="toc-section-number">4.6</span> More Information</a></li>
</ul></li>
<li><a href="5-association-analysis-basic-concepts-and-algorithms.html#association-analysis-basic-concepts-and-algorithms"><span class="toc-section-number">5</span> Association Analysis: Basic Concepts and Algorithms</a>
<ul>
<li><a href="5-1-the-arules-package.html#the-arules-package"><span class="toc-section-number">5.1</span> The arules Package</a></li>
<li><a href="5-2-transactions.html#transactions"><span class="toc-section-number">5.2</span> Transactions</a>
<ul>
<li><a href="5-2-transactions.html#create-transactions"><span class="toc-section-number">5.2.1</span> Create Transactions</a></li>
<li><a href="5-2-transactions.html#inspect-transactions"><span class="toc-section-number">5.2.2</span> Inspect Transactions</a></li>
<li><a href="5-2-transactions.html#vertical-layout-transaction-id-lists"><span class="toc-section-number">5.2.3</span> Vertical Layout (Transaction ID Lists)</a></li>
</ul></li>
<li><a href="5-3-frequent-itemsets.html#frequent-itemsets"><span class="toc-section-number">5.3</span> Frequent Itemsets</a>
<ul>
<li><a href="5-3-frequent-itemsets.html#mine-frequent-itemsets"><span class="toc-section-number">5.3.1</span> Mine Frequent Itemsets</a></li>
<li><a href="5-3-frequent-itemsets.html#concise-representation-of-itemsets"><span class="toc-section-number">5.3.2</span> Concise Representation of Itemsets</a></li>
</ul></li>
<li><a href="5-4-association-rules.html#association-rules"><span class="toc-section-number">5.4</span> Association Rules</a>
<ul>
<li><a href="5-4-association-rules.html#mine-association-rules"><span class="toc-section-number">5.4.1</span> Mine Association Rules</a></li>
<li><a href="5-4-association-rules.html#calculate-additional-interest-measures"><span class="toc-section-number">5.4.2</span> Calculate Additional Interest Measures</a></li>
<li><a href="5-4-association-rules.html#mine-using-templates"><span class="toc-section-number">5.4.3</span> Mine Using Templates</a></li>
</ul></li>
<li><a href="5-5-association-rule-visualization.html#association-rule-visualization"><span class="toc-section-number">5.5</span> Association Rule Visualization</a></li>
<li><a href="5-6-interactive-visualizations.html#interactive-visualizations"><span class="toc-section-number">5.6</span> Interactive Visualizations</a>
<ul>
<li><a href="5-6-interactive-visualizations.html#interactive-inspect-with-sorting-filtering-and-paging"><span class="toc-section-number">5.6.1</span> Interactive Inspect With Sorting, Filtering and Paging</a></li>
<li><a href="5-6-interactive-visualizations.html#scatter-plot-1"><span class="toc-section-number">5.6.2</span> Scatter Plot</a></li>
<li><a href="5-6-interactive-visualizations.html#matrix-visualization"><span class="toc-section-number">5.6.3</span> Matrix Visualization</a></li>
<li><a href="5-6-interactive-visualizations.html#visualization-as-graph"><span class="toc-section-number">5.6.4</span> Visualization as Graph</a></li>
<li><a href="5-6-interactive-visualizations.html#interactive-rule-explorer"><span class="toc-section-number">5.6.5</span> Interactive Rule Explorer</a></li>
</ul></li>
</ul></li>
<li><a href="6-association-analysis-advanced-concepts.html#association-analysis-advanced-concepts"><span class="toc-section-number">6</span> Association Analysis: Advanced Concepts</a></li>
<li><a href="7-clustering-analysis.html#clustering-analysis"><span class="toc-section-number">7</span> Clustering Analysis</a>
<ul>
<li><a href="7-1-data-preparation.html#data-preparation"><span class="toc-section-number">7.1</span> Data Preparation</a>
<ul>
<li><a href="7-1-data-preparation.html#data-cleaning"><span class="toc-section-number">7.1.1</span> Data cleaning</a></li>
<li><a href="7-1-data-preparation.html#scale-data"><span class="toc-section-number">7.1.2</span> Scale data</a></li>
</ul></li>
<li><a href="7-2-clustering-methods.html#clustering-methods"><span class="toc-section-number">7.2</span> Clustering methods</a>
<ul>
<li><a href="7-2-clustering-methods.html#k-means-clustering"><span class="toc-section-number">7.2.1</span> k-means Clustering</a></li>
<li><a href="7-2-clustering-methods.html#hierarchical-clustering"><span class="toc-section-number">7.2.2</span> Hierarchical Clustering</a></li>
<li><a href="7-2-clustering-methods.html#density-based-clustering-with-dbscan"><span class="toc-section-number">7.2.3</span> Density-based clustering with DBSCAN</a></li>
<li><a href="7-2-clustering-methods.html#partitioning-around-medoids-pam"><span class="toc-section-number">7.2.4</span> Partitioning Around Medoids (PAM)</a></li>
<li><a href="7-2-clustering-methods.html#gaussian-mixture-models"><span class="toc-section-number">7.2.5</span> Gaussian Mixture Models</a></li>
<li><a href="7-2-clustering-methods.html#spectral-clustering"><span class="toc-section-number">7.2.6</span> Spectral clustering</a></li>
<li><a href="7-2-clustering-methods.html#fuzzy-c-means-clustering"><span class="toc-section-number">7.2.7</span> Fuzzy C-Means Clustering</a></li>
</ul></li>
<li><a href="7-3-internal-cluster-validation.html#internal-cluster-validation"><span class="toc-section-number">7.3</span> Internal Cluster Validation</a>
<ul>
<li><a href="7-3-internal-cluster-validation.html#compare-the-clustering-quality"><span class="toc-section-number">7.3.1</span> Compare the Clustering Quality</a></li>
<li><a href="7-3-internal-cluster-validation.html#silhouette-plot"><span class="toc-section-number">7.3.2</span> Silhouette plot</a></li>
<li><a href="7-3-internal-cluster-validation.html#find-optimal-number-of-clusters-for-k-means"><span class="toc-section-number">7.3.3</span> Find Optimal Number of Clusters for k-means</a></li>
<li><a href="7-3-internal-cluster-validation.html#visualizing-the-distance-matrix"><span class="toc-section-number">7.3.4</span> Visualizing the Distance Matrix</a></li>
</ul></li>
<li><a href="7-4-external-cluster-validation.html#external-cluster-validation"><span class="toc-section-number">7.4</span> External Cluster Validation</a></li>
<li><a href="7-5-advanced-data-preparation-for-clustering.html#advanced-data-preparation-for-clustering"><span class="toc-section-number">7.5</span> Advanced Data Preparation for Clustering</a>
<ul>
<li><a href="7-5-advanced-data-preparation-for-clustering.html#outlier-removal"><span class="toc-section-number">7.5.1</span> Outlier Removal</a></li>
<li><a href="7-5-advanced-data-preparation-for-clustering.html#clustering-tendency"><span class="toc-section-number">7.5.2</span> Clustering Tendency</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="decision-boundaries" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Decision Boundaries</h2>
<p>Classifiers create decision boundaries to discriminate between classes.
Different classifiers are able to create different shapes of decision
boundaries (e.g., some are strictly linear) and thus some classifiers
may perform better for certain datasets. This page visualizes the decision
boundaries found by several popular classification methods.</p>
<p>The following plot adds the decision boundary by evaluating the classifier
at evenly spaced grid points. Note that low resolution
(to make evaluation faster) will make
the decision boundary look like it has small steps even if it is a
(straight) line.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="4-5-decision-boundaries.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="4-5-decision-boundaries.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb435-2"><a href="4-5-decision-boundaries.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb435-3"><a href="4-5-decision-boundaries.html#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb435-4"><a href="4-5-decision-boundaries.html#cb435-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-5"><a href="4-5-decision-boundaries.html#cb435-5" aria-hidden="true" tabindex="-1"></a>decisionplot <span class="ot">&lt;-</span> <span class="cf">function</span>(model, x, <span class="at">cl =</span> <span class="cn">NULL</span>, <span class="at">predict_type =</span> <span class="st">&quot;class&quot;</span>,</span>
<span id="cb435-6"><a href="4-5-decision-boundaries.html#cb435-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">resolution =</span> <span class="dv">100</span>) {</span>
<span id="cb435-7"><a href="4-5-decision-boundaries.html#cb435-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-8"><a href="4-5-decision-boundaries.html#cb435-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(cl)) {</span>
<span id="cb435-9"><a href="4-5-decision-boundaries.html#cb435-9" aria-hidden="true" tabindex="-1"></a>    x_data <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(cl))</span>
<span id="cb435-10"><a href="4-5-decision-boundaries.html#cb435-10" aria-hidden="true" tabindex="-1"></a>    cl <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cl)</span>
<span id="cb435-11"><a href="4-5-decision-boundaries.html#cb435-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> cl <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb435-12"><a href="4-5-decision-boundaries.html#cb435-12" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(cl))</span>
<span id="cb435-13"><a href="4-5-decision-boundaries.html#cb435-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-14"><a href="4-5-decision-boundaries.html#cb435-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># resubstitution accuracy</span></span>
<span id="cb435-15"><a href="4-5-decision-boundaries.html#cb435-15" aria-hidden="true" tabindex="-1"></a>  prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, x_data, <span class="at">type =</span> predict_type)</span>
<span id="cb435-16"><a href="4-5-decision-boundaries.html#cb435-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(prediction)) prediction <span class="ot">&lt;-</span> prediction<span class="sc">$</span>class</span>
<span id="cb435-17"><a href="4-5-decision-boundaries.html#cb435-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(prediction))</span>
<span id="cb435-18"><a href="4-5-decision-boundaries.html#cb435-18" aria-hidden="true" tabindex="-1"></a>    prediction <span class="ot">&lt;-</span>  <span class="fu">factor</span>(prediction, <span class="at">labels =</span> <span class="fu">levels</span>(cl))</span>
<span id="cb435-19"><a href="4-5-decision-boundaries.html#cb435-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb435-20"><a href="4-5-decision-boundaries.html#cb435-20" aria-hidden="true" tabindex="-1"></a>    prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(prediction, <span class="at">levels =</span> <span class="fu">levels</span>(cl))</span>
<span id="cb435-21"><a href="4-5-decision-boundaries.html#cb435-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-22"><a href="4-5-decision-boundaries.html#cb435-22" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(<span class="at">data =</span> prediction, <span class="at">reference =</span> cl)</span>
<span id="cb435-23"><a href="4-5-decision-boundaries.html#cb435-23" aria-hidden="true" tabindex="-1"></a>  acc <span class="ot">&lt;-</span> cm<span class="sc">$</span>overall[<span class="st">&quot;Accuracy&quot;</span>]</span>
<span id="cb435-24"><a href="4-5-decision-boundaries.html#cb435-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-25"><a href="4-5-decision-boundaries.html#cb435-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># evaluate model on a grid</span></span>
<span id="cb435-26"><a href="4-5-decision-boundaries.html#cb435-26" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], range, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb435-27"><a href="4-5-decision-boundaries.html#cb435-27" aria-hidden="true" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(r[<span class="dv">1</span>,<span class="dv">1</span>], r[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb435-28"><a href="4-5-decision-boundaries.html#cb435-28" aria-hidden="true" tabindex="-1"></a>  ys <span class="ot">&lt;-</span> <span class="fu">seq</span>(r[<span class="dv">1</span>,<span class="dv">2</span>], r[<span class="dv">2</span>,<span class="dv">2</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb435-29"><a href="4-5-decision-boundaries.html#cb435-29" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(xs, <span class="at">each =</span> resolution), <span class="fu">rep</span>(ys, <span class="at">time =</span> resolution))</span>
<span id="cb435-30"><a href="4-5-decision-boundaries.html#cb435-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(g) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(r)</span>
<span id="cb435-31"><a href="4-5-decision-boundaries.html#cb435-31" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(g)</span>
<span id="cb435-32"><a href="4-5-decision-boundaries.html#cb435-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-33"><a href="4-5-decision-boundaries.html#cb435-33" aria-hidden="true" tabindex="-1"></a>  <span class="do">### guess how to get class labels from predict</span></span>
<span id="cb435-34"><a href="4-5-decision-boundaries.html#cb435-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">### (unfortunately not very consistent between models)</span></span>
<span id="cb435-35"><a href="4-5-decision-boundaries.html#cb435-35" aria-hidden="true" tabindex="-1"></a>  prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, g, <span class="at">type =</span> predict_type)</span>
<span id="cb435-36"><a href="4-5-decision-boundaries.html#cb435-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(prediction)) prediction <span class="ot">&lt;-</span> prediction<span class="sc">$</span>class</span>
<span id="cb435-37"><a href="4-5-decision-boundaries.html#cb435-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(prediction))</span>
<span id="cb435-38"><a href="4-5-decision-boundaries.html#cb435-38" aria-hidden="true" tabindex="-1"></a>    prediction <span class="ot">&lt;-</span>  <span class="fu">factor</span>(prediction, <span class="at">labels =</span> <span class="fu">levels</span>(cl))</span>
<span id="cb435-39"><a href="4-5-decision-boundaries.html#cb435-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb435-40"><a href="4-5-decision-boundaries.html#cb435-40" aria-hidden="true" tabindex="-1"></a>    prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(prediction, <span class="at">levels =</span> <span class="fu">levels</span>(cl))</span>
<span id="cb435-41"><a href="4-5-decision-boundaries.html#cb435-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-42"><a href="4-5-decision-boundaries.html#cb435-42" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(prediction)</span>
<span id="cb435-43"><a href="4-5-decision-boundaries.html#cb435-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-44"><a href="4-5-decision-boundaries.html#cb435-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(g, <span class="at">mapping =</span> <span class="fu">aes_string</span>(</span>
<span id="cb435-45"><a href="4-5-decision-boundaries.html#cb435-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">colnames</span>(g)[<span class="dv">1</span>],</span>
<span id="cb435-46"><a href="4-5-decision-boundaries.html#cb435-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">colnames</span>(g)[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb435-47"><a href="4-5-decision-boundaries.html#cb435-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> prediction)) <span class="sc">+</span></span>
<span id="cb435-48"><a href="4-5-decision-boundaries.html#cb435-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> x, <span class="at">mapping =</span>  <span class="fu">aes_string</span>(</span>
<span id="cb435-49"><a href="4-5-decision-boundaries.html#cb435-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">colnames</span>(x)[<span class="dv">1</span>],</span>
<span id="cb435-50"><a href="4-5-decision-boundaries.html#cb435-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">colnames</span>(x)[<span class="dv">2</span>],</span>
<span id="cb435-51"><a href="4-5-decision-boundaries.html#cb435-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="fu">colnames</span>(x)[<span class="dv">3</span>]), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb435-52"><a href="4-5-decision-boundaries.html#cb435-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Training accuracy:&quot;</span>, <span class="fu">round</span>(acc, <span class="dv">2</span>)))</span>
<span id="cb435-53"><a href="4-5-decision-boundaries.html#cb435-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="iris-dataset" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Iris Dataset</h3>
<p>For easier visualization, we use on two dimensions of the Iris dataset.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="4-5-decision-boundaries.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb436-2"><a href="4-5-decision-boundaries.html#cb436-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb436-3"><a href="4-5-decision-boundaries.html#cb436-3" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span>
<span id="cb436-4"><a href="4-5-decision-boundaries.html#cb436-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-5"><a href="4-5-decision-boundaries.html#cb436-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Three classes (MASS also has a select function)</span></span>
<span id="cb436-6"><a href="4-5-decision-boundaries.html#cb436-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Sepal.Length, Sepal.Width, Species)</span>
<span id="cb436-7"><a href="4-5-decision-boundaries.html#cb436-7" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## # A tibble: 150 x 3
##    Sepal.Length Sepal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1          5.1         3.5 setosa 
##  2          4.9         3   setosa 
##  3          4.7         3.2 setosa 
##  4          4.6         3.1 setosa 
##  5          5           3.6 setosa 
##  6          5.4         3.9 setosa 
##  7          4.6         3.4 setosa 
##  8          5           3.4 setosa 
##  9          4.4         2.9 setosa 
## 10          4.9         3.1 setosa 
## # â€¦ with 140 more rows</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="4-5-decision-boundaries.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width, <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p><em>Note:</em> There is some overplotting and you could use <code>geom_jitter()</code> instead of <code>geom_point()</code>.</p>
<div id="k-nearest-neighbors-classifier" class="section level4" number="4.5.1.1">
<h4><span class="header-section-number">4.5.1.1</span> K-Nearest Neighbors Classifier</h4>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="4-5-decision-boundaries.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb439-2"><a href="4-5-decision-boundaries.html#cb439-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">knn3</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb439-3"><a href="4-5-decision-boundaries.html#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;kNN (1 neighbor)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="4-5-decision-boundaries.html#cb440-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">knn3</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb440-2"><a href="4-5-decision-boundaries.html#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;kNN (10 neighbor)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-166-2.png" width="672" /></p>
</div>
<div id="naive-bayes-classifier" class="section level4" number="4.5.1.2">
<h4><span class="header-section-number">4.5.1.2</span> Naive Bayes Classifier</h4>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="4-5-decision-boundaries.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb441-2"><a href="4-5-decision-boundaries.html#cb441-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">naiveBayes</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb441-3"><a href="4-5-decision-boundaries.html#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Naive Bayes&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
<div id="linear-discriminant-analysis" class="section level4" number="4.5.1.3">
<h4><span class="header-section-number">4.5.1.3</span> Linear Discriminant Analysis</h4>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="4-5-decision-boundaries.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="4-5-decision-boundaries.html#cb445-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">lda</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb445-2"><a href="4-5-decision-boundaries.html#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;LDA&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
</div>
<div id="multinomial-logistic-regression-implemented-in-nnet" class="section level4" number="4.5.1.4">
<h4><span class="header-section-number">4.5.1.4</span> Multinomial Logistic Regression (implemented in nnet)</h4>
<p>Multinomial logistic regression is an extension of logistic regression to problems with more than two classes.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="4-5-decision-boundaries.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb446-2"><a href="4-5-decision-boundaries.html#cb446-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">multinom</span>(Species <span class="sc">~</span>., <span class="at">data =</span> .)</span></code></pre></div>
<pre><code>## # weights:  12 (6 variable)
## initial  value 164.791843 
## iter  10 value 62.715967
## iter  20 value 59.808291
## iter  30 value 55.445984
## iter  40 value 55.375704
## iter  50 value 55.346472
## iter  60 value 55.301707
## iter  70 value 55.253532
## iter  80 value 55.243230
## iter  90 value 55.230241
## iter 100 value 55.212479
## final  value 55.212479 
## stopped after 100 iterations</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="4-5-decision-boundaries.html#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">titel =</span> <span class="st">&quot;Multinomial Logistic Regression&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
<div id="decision-trees-1" class="section level4" number="4.5.1.5">
<h4><span class="header-section-number">4.5.1.5</span> Decision Trees</h4>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="4-5-decision-boundaries.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;rpart&quot;</span>)</span>
<span id="cb449-2"><a href="4-5-decision-boundaries.html#cb449-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">rpart</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb449-3"><a href="4-5-decision-boundaries.html#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;CART&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="4-5-decision-boundaries.html#cb450-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">rpart</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> .,</span>
<span id="cb450-2"><a href="4-5-decision-boundaries.html#cb450-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="fl">0.001</span>, <span class="at">minsplit =</span> <span class="dv">1</span>))</span>
<span id="cb450-3"><a href="4-5-decision-boundaries.html#cb450-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;CART (overfitting)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-170-2.png" width="672" /></p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="4-5-decision-boundaries.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(C50)</span>
<span id="cb451-2"><a href="4-5-decision-boundaries.html#cb451-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">C5.0</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb451-3"><a href="4-5-decision-boundaries.html#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C5.0&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-170-3.png" width="672" /></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="4-5-decision-boundaries.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code></pre></div>
<pre><code>## randomForest 4.6-14</code></pre>
<pre><code>## Type rfNews() to see new features/changes/bug fixes.</code></pre>
<pre><code>## 
## Attaching package: &#39;randomForest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     margin</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="4-5-decision-boundaries.html#cb458-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">randomForest</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb458-2"><a href="4-5-decision-boundaries.html#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Random Forest&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-170-4.png" width="672" /></p>
</div>
<div id="svm" class="section level4" number="4.5.1.6">
<h4><span class="header-section-number">4.5.1.6</span> SVM</h4>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="4-5-decision-boundaries.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb459-2"><a href="4-5-decision-boundaries.html#cb459-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;linear&quot;</span>)</span>
<span id="cb459-3"><a href="4-5-decision-boundaries.html#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (linear kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="4-5-decision-boundaries.html#cb460-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>)</span>
<span id="cb460-2"><a href="4-5-decision-boundaries.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (radial kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-171-2.png" width="672" /></p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="4-5-decision-boundaries.html#cb461-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;polynomial&quot;</span>)</span>
<span id="cb461-2"><a href="4-5-decision-boundaries.html#cb461-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (polynomial kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-171-3.png" width="672" /></p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="4-5-decision-boundaries.html#cb462-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;sigmoid&quot;</span>)</span>
<span id="cb462-2"><a href="4-5-decision-boundaries.html#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (sigmoid kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-171-4.png" width="672" /></p>
</div>
<div id="single-layer-feed-forward-neural-networks" class="section level4" number="4.5.1.7">
<h4><span class="header-section-number">4.5.1.7</span> Single Layer Feed-forward Neural Networks</h4>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="4-5-decision-boundaries.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb463-2"><a href="4-5-decision-boundaries.html#cb463-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb463-3"><a href="4-5-decision-boundaries.html#cb463-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (1 neuron)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="4-5-decision-boundaries.html#cb464-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">2</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb464-2"><a href="4-5-decision-boundaries.html#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (2 neurons)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-172-2.png" width="672" /></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="4-5-decision-boundaries.html#cb465-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">4</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb465-2"><a href="4-5-decision-boundaries.html#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (4 neurons)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-172-3.png" width="672" /></p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="4-5-decision-boundaries.html#cb466-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">10</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb466-2"><a href="4-5-decision-boundaries.html#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (10 neurons)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-172-4.png" width="672" /></p>
</div>
<div id="deep-learning-with-keras" class="section level4" number="4.5.1.8">
<h4><span class="header-section-number">4.5.1.8</span> Deep Learning with keras</h4>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="4-5-decision-boundaries.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span></code></pre></div>
<p>define predict so it works with decision plot</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="4-5-decision-boundaries.html#cb468-1" aria-hidden="true" tabindex="-1"></a>predict.keras.engine.training.Model <span class="ot">&lt;-</span> <span class="cf">function</span>(object, newdata, ...)</span>
<span id="cb468-2"><a href="4-5-decision-boundaries.html#cb468-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict_classes</span>(object, <span class="fu">as.matrix</span>(newdata))</span></code></pre></div>
<p>Choices are the activation function, number of layers, number of units per layer and the optimizer.
A L2 regularizer is used for the dense layer weights to reduce overfitting. The output is a
categorical class value, therefore the output layer uses the softmax activation function,
the loss is categorical crossentropy, and the metric is accuracy.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="4-5-decision-boundaries.html#cb469-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>() <span class="sc">%&gt;%</span></span>
<span id="cb469-2"><a href="4-5-decision-boundaries.html#cb469-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">10</span>, <span class="at">activation =</span> <span class="st">&#39;relu&#39;</span>, <span class="at">input_shape =</span> <span class="fu">c</span>(<span class="dv">2</span>),</span>
<span id="cb469-3"><a href="4-5-decision-boundaries.html#cb469-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">kernel_regularizer=</span><span class="fu">regularizer_l2</span>(<span class="at">l=</span><span class="fl">0.01</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb469-4"><a href="4-5-decision-boundaries.html#cb469-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">4</span>, <span class="at">activation =</span> <span class="st">&#39;softmax&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-5"><a href="4-5-decision-boundaries.html#cb469-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compile</span>(<span class="at">loss =</span> <span class="st">&#39;categorical_crossentropy&#39;</span>, <span class="at">optimizer =</span> <span class="st">&#39;adam&#39;</span>, <span class="at">metrics =</span> <span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb469-6"><a href="4-5-decision-boundaries.html#cb469-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-7"><a href="4-5-decision-boundaries.html#cb469-7" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb469-8"><a href="4-5-decision-boundaries.html#cb469-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb469-9"><a href="4-5-decision-boundaries.html#cb469-9" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> as.integer <span class="sc">%&gt;%</span> <span class="fu">to_categorical</span>(),</span>
<span id="cb469-10"><a href="4-5-decision-boundaries.html#cb469-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">100</span>,</span>
<span id="cb469-11"><a href="4-5-decision-boundaries.html#cb469-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">10</span></span>
<span id="cb469-12"><a href="4-5-decision-boundaries.html#cb469-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb469-13"><a href="4-5-decision-boundaries.html#cb469-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-14"><a href="4-5-decision-boundaries.html#cb469-14" aria-hidden="true" tabindex="-1"></a>history</span></code></pre></div>
<pre><code>## 
## Final epoch (plot to see history):
##     loss: 0.7084
## accuracy: 0.68</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="4-5-decision-boundaries.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;keras (relu activation)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="4-5-decision-boundaries.html#cb472-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>() <span class="sc">%&gt;%</span></span>
<span id="cb472-2"><a href="4-5-decision-boundaries.html#cb472-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">10</span>, <span class="at">activation =</span> <span class="st">&#39;tanh&#39;</span>, <span class="at">input_shape =</span> <span class="fu">c</span>(<span class="dv">2</span>),</span>
<span id="cb472-3"><a href="4-5-decision-boundaries.html#cb472-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">kernel_regularizer =</span> <span class="fu">regularizer_l2</span>(<span class="at">l =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb472-4"><a href="4-5-decision-boundaries.html#cb472-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">4</span>, <span class="at">activation =</span> <span class="st">&#39;softmax&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb472-5"><a href="4-5-decision-boundaries.html#cb472-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compile</span>(<span class="at">loss =</span> <span class="st">&#39;categorical_crossentropy&#39;</span>, <span class="at">optimizer =</span> <span class="st">&#39;adam&#39;</span>, <span class="at">metrics =</span> <span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb472-6"><a href="4-5-decision-boundaries.html#cb472-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-7"><a href="4-5-decision-boundaries.html#cb472-7" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb472-8"><a href="4-5-decision-boundaries.html#cb472-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb472-9"><a href="4-5-decision-boundaries.html#cb472-9" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> as.integer <span class="sc">%&gt;%</span> <span class="fu">to_categorical</span>(),</span>
<span id="cb472-10"><a href="4-5-decision-boundaries.html#cb472-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">100</span>,</span>
<span id="cb472-11"><a href="4-5-decision-boundaries.html#cb472-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">10</span></span>
<span id="cb472-12"><a href="4-5-decision-boundaries.html#cb472-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb472-13"><a href="4-5-decision-boundaries.html#cb472-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-14"><a href="4-5-decision-boundaries.html#cb472-14" aria-hidden="true" tabindex="-1"></a>history</span></code></pre></div>
<pre><code>## 
## Final epoch (plot to see history):
##     loss: 0.552
## accuracy: 0.7267</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="4-5-decision-boundaries.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;keras (tanh activation)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-175-2.png" width="672" /></p>
</div>
</div>
<div id="circle-dataset" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Circle Dataset</h3>
<p>This set is not linearly separable!</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="4-5-decision-boundaries.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb475-2"><a href="4-5-decision-boundaries.html#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="4-5-decision-boundaries.html#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlbench)</span>
<span id="cb475-4"><a href="4-5-decision-boundaries.html#cb475-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">mlbench.circle</span>(<span class="dv">500</span>)</span>
<span id="cb475-5"><a href="4-5-decision-boundaries.html#cb475-5" aria-hidden="true" tabindex="-1"></a><span class="do">###x &lt;- mlbench.cassini(500)</span></span>
<span id="cb475-6"><a href="4-5-decision-boundaries.html#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="do">###x &lt;- mlbench.spirals(500, sd = .1)</span></span>
<span id="cb475-7"><a href="4-5-decision-boundaries.html#cb475-7" aria-hidden="true" tabindex="-1"></a><span class="do">###x &lt;- mlbench.smiley(500)</span></span>
<span id="cb475-8"><a href="4-5-decision-boundaries.html#cb475-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(x<span class="sc">$</span>x), <span class="fu">factor</span>(x<span class="sc">$</span>classes))</span>
<span id="cb475-9"><a href="4-5-decision-boundaries.html#cb475-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;class&quot;</span>)</span>
<span id="cb475-10"><a href="4-5-decision-boundaries.html#cb475-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(x)</span>
<span id="cb475-11"><a href="4-5-decision-boundaries.html#cb475-11" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## # A tibble: 500 x 3
##          x       y class
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;
##  1 -0.344   0.448  1    
##  2  0.518   0.915  2    
##  3 -0.772  -0.0913 1    
##  4  0.382   0.412  1    
##  5  0.0328  0.438  1    
##  6 -0.865  -0.354  2    
##  7  0.477   0.640  2    
##  8  0.167  -0.809  2    
##  9 -0.568  -0.281  1    
## 10 -0.488   0.638  2    
## # â€¦ with 490 more rows</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="4-5-decision-boundaries.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> class)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
<div id="k-nearest-neighbors-classifier-1" class="section level4" number="4.5.2.1">
<h4><span class="header-section-number">4.5.2.1</span> K-Nearest Neighbors Classifier</h4>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="4-5-decision-boundaries.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb478-2"><a href="4-5-decision-boundaries.html#cb478-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">knn3</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb478-3"><a href="4-5-decision-boundaries.html#cb478-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;kNN (1 neighbor)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="4-5-decision-boundaries.html#cb479-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">knn3</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb479-2"><a href="4-5-decision-boundaries.html#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;kNN (10 neighbor)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-177-2.png" width="672" /></p>
</div>
<div id="naive-bayes-classifier-1" class="section level4" number="4.5.2.2">
<h4><span class="header-section-number">4.5.2.2</span> Naive Bayes Classifier</h4>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="4-5-decision-boundaries.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb480-2"><a href="4-5-decision-boundaries.html#cb480-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">naiveBayes</span>(class <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb480-3"><a href="4-5-decision-boundaries.html#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;naive Bayes&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
<div id="linear-discriminant-analysis-1" class="section level4" number="4.5.2.3">
<h4><span class="header-section-number">4.5.2.3</span> Linear Discriminant Analysis</h4>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="4-5-decision-boundaries.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb481-2"><a href="4-5-decision-boundaries.html#cb481-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">lda</span>(class <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb481-3"><a href="4-5-decision-boundaries.html#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;LDA&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
</div>
<div id="multinomial-logistic-regression-implemented-in-nnet-1" class="section level4" number="4.5.2.4">
<h4><span class="header-section-number">4.5.2.4</span> Multinomial Logistic Regression (implemented in nnet)</h4>
<p>Multinomial logistic regression is an extension of logistic regression to problems with more than two classes.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="4-5-decision-boundaries.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb482-2"><a href="4-5-decision-boundaries.html#cb482-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">multinom</span>(class <span class="sc">~</span>., <span class="at">data =</span> .)</span></code></pre></div>
<pre><code>## # weights:  4 (3 variable)
## initial  value 346.573590 
## final  value 346.308371 
## converged</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="4-5-decision-boundaries.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">titel =</span> <span class="st">&quot;Multinomial Logistic Regression&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="decision-trees-2" class="section level4" number="4.5.2.5">
<h4><span class="header-section-number">4.5.2.5</span> Decision Trees</h4>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="4-5-decision-boundaries.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;rpart&quot;</span>)</span>
<span id="cb485-2"><a href="4-5-decision-boundaries.html#cb485-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">rpart</span>(class <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb485-3"><a href="4-5-decision-boundaries.html#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;CART&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="4-5-decision-boundaries.html#cb486-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">rpart</span>(class <span class="sc">~</span> ., <span class="at">data =</span> .,</span>
<span id="cb486-2"><a href="4-5-decision-boundaries.html#cb486-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="fl">0.001</span>, <span class="at">minsplit =</span> <span class="dv">1</span>))</span>
<span id="cb486-3"><a href="4-5-decision-boundaries.html#cb486-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;CART (overfitting)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-181-2.png" width="672" /></p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="4-5-decision-boundaries.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(C50)</span>
<span id="cb487-2"><a href="4-5-decision-boundaries.html#cb487-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">C5.0</span>(class <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb487-3"><a href="4-5-decision-boundaries.html#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C5.0&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-181-3.png" width="672" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="4-5-decision-boundaries.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb488-2"><a href="4-5-decision-boundaries.html#cb488-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">randomForest</span>(class <span class="sc">~</span> ., <span class="at">data =</span> .)</span>
<span id="cb488-3"><a href="4-5-decision-boundaries.html#cb488-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Random Forest&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-181-4.png" width="672" /></p>
</div>
<div id="svm-1" class="section level4" number="4.5.2.6">
<h4><span class="header-section-number">4.5.2.6</span> SVM</h4>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="4-5-decision-boundaries.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb489-2"><a href="4-5-decision-boundaries.html#cb489-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;linear&quot;</span>)</span>
<span id="cb489-3"><a href="4-5-decision-boundaries.html#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (linear kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="4-5-decision-boundaries.html#cb490-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>)</span>
<span id="cb490-2"><a href="4-5-decision-boundaries.html#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (radial kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-182-2.png" width="672" /></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="4-5-decision-boundaries.html#cb491-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;polynomial&quot;</span>)</span>
<span id="cb491-2"><a href="4-5-decision-boundaries.html#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (polynomial kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-182-3.png" width="672" /></p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="4-5-decision-boundaries.html#cb492-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">svm</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">kernel =</span> <span class="st">&quot;sigmoid&quot;</span>)</span>
<span id="cb492-2"><a href="4-5-decision-boundaries.html#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SVM (sigmoid kernel)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-182-4.png" width="672" /></p>
</div>
<div id="single-layer-feed-forward-neural-networks-1" class="section level4" number="4.5.2.7">
<h4><span class="header-section-number">4.5.2.7</span> Single Layer Feed-forward Neural Networks</h4>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="4-5-decision-boundaries.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb493-2"><a href="4-5-decision-boundaries.html#cb493-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb493-3"><a href="4-5-decision-boundaries.html#cb493-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (1 neuron)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="4-5-decision-boundaries.html#cb494-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">2</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb494-2"><a href="4-5-decision-boundaries.html#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (2 neurons)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-183-2.png" width="672" /></p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="4-5-decision-boundaries.html#cb495-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">4</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb495-2"><a href="4-5-decision-boundaries.html#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (4 neurons)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-183-3.png" width="672" /></p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="4-5-decision-boundaries.html#cb496-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">nnet</span>(class <span class="sc">~</span> ., <span class="at">data =</span> ., <span class="at">size =</span> <span class="dv">10</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb496-2"><a href="4-5-decision-boundaries.html#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NN (10 neurons)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-183-4.png" width="672" /></p>
</div>
<div id="deep-learning-with-keras-1" class="section level4" number="4.5.2.8">
<h4><span class="header-section-number">4.5.2.8</span> Deep Learning with keras</h4>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="4-5-decision-boundaries.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span></code></pre></div>
<p>redefine predict so it works with decision plot</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="4-5-decision-boundaries.html#cb498-1" aria-hidden="true" tabindex="-1"></a>predict.keras.engine.training.Model <span class="ot">&lt;-</span> <span class="cf">function</span>(object, newdata, ...)</span>
<span id="cb498-2"><a href="4-5-decision-boundaries.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict_classes</span>(object, <span class="fu">as.matrix</span>(newdata))</span></code></pre></div>
<p>Choices are the activation function, number of layers, number of units per layer and the optimizer.
A L2 regularizer is used for the dense layer weights to reduce overfitting. The output is a
categorical class value, therefore the output layer uses the softmax activation function,
the loss is categorical crossentropy, and the metric is accuracy.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="4-5-decision-boundaries.html#cb499-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>() <span class="sc">%&gt;%</span></span>
<span id="cb499-2"><a href="4-5-decision-boundaries.html#cb499-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">10</span>, <span class="at">activation =</span> <span class="st">&#39;relu&#39;</span>, <span class="at">input_shape =</span> <span class="fu">c</span>(<span class="dv">2</span>),</span>
<span id="cb499-3"><a href="4-5-decision-boundaries.html#cb499-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">kernel_regularizer=</span><span class="fu">regularizer_l2</span>(<span class="at">l =</span> <span class="fl">0.0001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb499-4"><a href="4-5-decision-boundaries.html#cb499-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">3</span>, <span class="at">activation =</span> <span class="st">&#39;softmax&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb499-5"><a href="4-5-decision-boundaries.html#cb499-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compile</span>(<span class="at">loss =</span> <span class="st">&#39;categorical_crossentropy&#39;</span>, <span class="at">optimizer =</span> <span class="st">&#39;adam&#39;</span>, <span class="at">metrics =</span> <span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb499-6"><a href="4-5-decision-boundaries.html#cb499-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-7"><a href="4-5-decision-boundaries.html#cb499-7" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb499-8"><a href="4-5-decision-boundaries.html#cb499-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb499-9"><a href="4-5-decision-boundaries.html#cb499-9" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> as.integer <span class="sc">%&gt;%</span> <span class="fu">to_categorical</span>(),</span>
<span id="cb499-10"><a href="4-5-decision-boundaries.html#cb499-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">100</span>,</span>
<span id="cb499-11"><a href="4-5-decision-boundaries.html#cb499-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">10</span></span>
<span id="cb499-12"><a href="4-5-decision-boundaries.html#cb499-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb499-13"><a href="4-5-decision-boundaries.html#cb499-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-14"><a href="4-5-decision-boundaries.html#cb499-14" aria-hidden="true" tabindex="-1"></a>history</span></code></pre></div>
<pre><code>## 
## Final epoch (plot to see history):
##     loss: 0.1849
## accuracy: 0.95</code></pre>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="4-5-decision-boundaries.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;keras (relu activation)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="4-5-decision-boundaries.html#cb502-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>() <span class="sc">%&gt;%</span></span>
<span id="cb502-2"><a href="4-5-decision-boundaries.html#cb502-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">10</span>, <span class="at">activation =</span> <span class="st">&#39;tanh&#39;</span>, <span class="at">input_shape =</span> <span class="fu">c</span>(<span class="dv">2</span>),</span>
<span id="cb502-3"><a href="4-5-decision-boundaries.html#cb502-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">kernel_regularizer =</span> <span class="fu">regularizer_l2</span>(<span class="at">l =</span> <span class="fl">0.0001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb502-4"><a href="4-5-decision-boundaries.html#cb502-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">3</span>, <span class="at">activation =</span> <span class="st">&#39;softmax&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb502-5"><a href="4-5-decision-boundaries.html#cb502-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compile</span>(<span class="at">loss =</span> <span class="st">&#39;categorical_crossentropy&#39;</span>, <span class="at">optimizer =</span> <span class="st">&#39;adam&#39;</span>, <span class="at">metrics =</span> <span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb502-6"><a href="4-5-decision-boundaries.html#cb502-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-7"><a href="4-5-decision-boundaries.html#cb502-7" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb502-8"><a href="4-5-decision-boundaries.html#cb502-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb502-9"><a href="4-5-decision-boundaries.html#cb502-9" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> as.integer <span class="sc">%&gt;%</span> <span class="fu">to_categorical</span>(),</span>
<span id="cb502-10"><a href="4-5-decision-boundaries.html#cb502-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">100</span>,</span>
<span id="cb502-11"><a href="4-5-decision-boundaries.html#cb502-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">10</span></span>
<span id="cb502-12"><a href="4-5-decision-boundaries.html#cb502-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb502-13"><a href="4-5-decision-boundaries.html#cb502-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-14"><a href="4-5-decision-boundaries.html#cb502-14" aria-hidden="true" tabindex="-1"></a>history</span></code></pre></div>
<pre><code>## 
## Final epoch (plot to see history):
##     loss: 0.3817
## accuracy: 0.922</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="4-5-decision-boundaries.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">cl =</span> <span class="st">&quot;class&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;keras (tanh activation)&quot;</span>)</span></code></pre></div>
<p><img src="R-Code-Companion-for-Introduction-to-Data-Mining_files/figure-html/unnamed-chunk-186-2.png" width="672" /></p>
</div>
</div>
</div>
<p style="text-align: center;">
<a href="4-4-applying-the-chosen-model-to-the-test-data.html"><button class="btn btn-default">Previous</button></a>
<a href="4-6-more-information.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
