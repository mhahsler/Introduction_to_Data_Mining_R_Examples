<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Data | An R Companion for Introduction to Data Mining</title>
<meta name="author" content="Michael Hahsler">
<meta name="description" content="Data for data mining is typically organized in tabular form, with rows containing the objects of interest and columns representing attributes describing the objects. We will discuss topics like...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 2 Data | An R Companion for Introduction to Data Mining">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content="Data for data mining is typically organized in tabular form, with rows containing the objects of interest and columns representing attributes describing the objects. We will discuss topics like...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Data | An R Companion for Introduction to Data Mining">
<meta name="twitter:description" content="Data for data mining is typically organized in tabular form, with rows containing the objects of interest and columns representing attributes describing the objects. We will discuss topics like...">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><link href="libs/htmltools-fill/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding/datatables.js"></script><link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script><link href="libs/nouislider/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider/jquery.nouislider.min.js"></script><link href="libs/selectize/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize/selectize.min.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">An R Companion for Introduction to Data Mining</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="active" href="data.html"><span class="header-section-number">2</span> Data</a></li>
<li><a class="" href="classification-basic-concepts.html"><span class="header-section-number">3</span> Classification: Basic Concepts</a></li>
<li><a class="" href="classification-alternative-techniques.html"><span class="header-section-number">4</span> Classification: Alternative Techniques</a></li>
<li><a class="" href="association-analysis-basic-concepts.html"><span class="header-section-number">5</span> Association Analysis: Basic Concepts</a></li>
<li><a class="" href="association-analysis-advanced-concepts.html"><span class="header-section-number">6</span> Association Analysis: Advanced Concepts</a></li>
<li><a class="" href="cluster-analysis.html"><span class="header-section-number">7</span> Cluster Analysis</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="data-exploration-and-visualization.html"><span class="header-section-number">A</span> Data Exploration and Visualization</a></li>
<li><a class="" href="appendix_regression.html"><span class="header-section-number">B</span> Regression</a></li>
<li><a class="" href="appendix_logistic_regression.html"><span class="header-section-number">C</span> Logistic Regression</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mhahsler/Introduction_to_Data_Mining_R_Examples">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h1>
<p>Data for data mining is typically organized in tabular form, with rows containing
the objects of interest and columns representing attributes describing the objects.
We will discuss topics like data quality, sampling, feature selection,
and how to measure similarities between objects and features.</p>
<p>After this chapter, you can read Appendix A <a href="data-exploration-and-visualization.html#data-exploration-and-visualization">Data Exploration and Visualization</a>
to learn more about data exploration and visualization in R.</p>
<div id="packages-used-in-this-chapter" class="section level3 unnumbered">
<h3>Packages Used in this Chapter<a class="anchor" aria-label="anchor" href="#packages-used-in-this-chapter"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"arules"</span>, <span class="st">"caret"</span>, <span class="st">"factoextra"</span>, <span class="st">"GGally"</span>, </span>
<span>          <span class="st">"palmerpenguins"</span>, <span class="st">"plotly"</span>, </span>
<span>          <span class="st">"proxy"</span>, <span class="st">"Rtsne"</span>, <span class="st">"tidyverse"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pkgs_install</span> <span class="op">&lt;-</span> <span class="va">pkgs</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">pkgs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span>,<span class="st">"Package"</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pkgs_install</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">pkgs_install</span><span class="op">)</span></span></code></pre></div>
<p>The packages used for this chapter are:</p>
<ul>
<li>
<em>arules</em> <span class="citation">(<a href="references.html#ref-R-arules">Hahsler et al. 2025</a>)</span>
</li>
<li>
<em>caret</em> <span class="citation">(<a href="references.html#ref-R-caret">Kuhn 2024</a>)</span>
</li>
<li>
<em>factoextra</em> <span class="citation">(<a href="references.html#ref-R-factoextra">Kassambara and Mundt 2020</a>)</span>
</li>
<li>
<em>GGally</em> <span class="citation">(<a href="references.html#ref-R-GGally">Schloerke et al. 2024</a>)</span>
</li>
<li>
<em>palmerpenguins</em> <span class="citation">(<a href="references.html#ref-R-palmerpenguins">Horst, Hill, and Gorman 2022</a>)</span>
</li>
<li>
<em>plotly</em> <span class="citation">(<a href="references.html#ref-R-plotly">Sievert et al. 2024</a>)</span>
</li>
<li>
<em>proxy</em> <span class="citation">(<a href="references.html#ref-R-proxy">Meyer and Buchta 2022</a>)</span>
</li>
<li>
<em>Rtsne</em> <span class="citation">(<a href="references.html#ref-R-Rtsne">Krijthe 2023</a>)</span>
</li>
<li>
<em>tidyverse</em> <span class="citation">(<a href="references.html#ref-R-tidyverse">Wickham 2023c</a>)</span>
</li>
</ul>
</div>
<div id="types-of-data" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Types of Data<a class="anchor" aria-label="anchor" href="#types-of-data"><i class="fas fa-link"></i></a>
</h2>
<div id="attributes-and-measurement" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> Attributes and Measurement<a class="anchor" aria-label="anchor" href="#attributes-and-measurement"><i class="fas fa-link"></i></a>
</h3>
<p>The values of features can be measured on <a href="https://en.wikipedia.org/wiki/Level_of_measurement">several scales</a>
ranging from
simple labels all the way to numbers. The scales come in four levels.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="22%">
<col width="26%">
<col width="20%">
<col width="15%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th>Scale Name</th>
<th>Description</th>
<th>Operations</th>
<th>Statistics</th>
<th>R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Nominal</td>
<td>just a label (e.g., red, green)</td>
<td><span class="math inline">\(==, !=\)</span></td>
<td>counts</td>
<td><code>factor</code></td>
</tr>
<tr class="even">
<td>Ordinal</td>
<td>label with order (e.g., small, med., large)</td>
<td><span class="math inline">\(&lt;, &gt;\)</span></td>
<td>median</td>
<td><code>ordered factor</code></td>
</tr>
<tr class="odd">
<td>Interval</td>
<td>difference between two values is meaningful (regular number)</td>
<td><span class="math inline">\(+, -\)</span></td>
<td>mean, sd</td>
<td><code>numeric</code></td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>has a natural zero (e.g., count, distance)</td>
<td><span class="math inline">\(/, *\)</span></td>
<td>percent</td>
<td><code>numeric</code></td>
</tr>
</tbody>
</table></div>
<p>The scales build on each other meaning that an ordinal variable also has the characteristics of
a nominal variable with the added order information.
We often do not differentiate between interval and ratio scale because we rarely
not need to calculate percentages or other statistics that require a meaningful zero value.</p>
<p>Nominal data is created using <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>. If the factor levels
are not specified, then they are created in alphabetical order.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] red   green green blue </span></span>
<span><span class="co">## Levels: blue green red</span></span></code></pre></div>
<p>Ordinal data is created using <code><a href="https://rdrr.io/r/base/factor.html">ordered()</a></code>. The levels specify the order.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"L"</span>, <span class="st">"M"</span>, <span class="st">"S"</span><span class="op">)</span>, </span>
<span>       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"M"</span>, <span class="st">"L"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] S L M S</span></span>
<span><span class="co">## Levels: S &lt; M &lt; L</span></span></code></pre></div>
<p>Ratio/interval data is created as a simple vector.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">## [1] 1 2 3 4 3 3</span></span></code></pre></div>
</div>
<div id="the-iris-dataset" class="section level3" number="2.1.2">
<h3>
<span class="header-section-number">2.1.2</span> The Iris Dataset<a class="anchor" aria-label="anchor" href="#the-iris-dataset"><i class="fas fa-link"></i></a>
</h3>
<p>We will use a toy dataset that comes with R. <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">Fisher’s iris
dataset</a> gives the
measurements in centimeters of the variables sepal length, sepal width
petal length, and petal width representing the features for 150 flowers (the objects).
The dataset contains 50
flowers from each of 3 species of iris. The species are Iris Setosa,
Iris Versicolor, and Iris Virginica. For more details see <code><a href="https://rdrr.io/r/datasets/iris.html">? iris</a></code>.</p>
<p>We load the iris data set. Datasets that come with R or R packages can
be loaded with <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code>. The standard format for data in R is a
data.frame. We convert the data.frame into a tidyverse tibble.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris</span></span>
<span><span class="co">## # A tibble: 150 × 5</span></span>
<span><span class="co">##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span><span class="co">##  1          5.1         3.5          1.4         0.2 setosa </span></span>
<span><span class="co">##  2          4.9         3            1.4         0.2 setosa </span></span>
<span><span class="co">##  3          4.7         3.2          1.3         0.2 setosa </span></span>
<span><span class="co">##  4          4.6         3.1          1.5         0.2 setosa </span></span>
<span><span class="co">##  5          5           3.6          1.4         0.2 setosa </span></span>
<span><span class="co">##  6          5.4         3.9          1.7         0.4 setosa </span></span>
<span><span class="co">##  7          4.6         3.4          1.4         0.3 setosa </span></span>
<span><span class="co">##  8          5           3.4          1.5         0.2 setosa </span></span>
<span><span class="co">##  9          4.4         2.9          1.4         0.2 setosa </span></span>
<span><span class="co">## 10          4.9         3.1          1.5         0.1 setosa </span></span>
<span><span class="co">## # ℹ 140 more rows</span></span></code></pre></div>
<p>We see that the data contains 150 rows (flowers) and 5 features. tibbles
only show the first few rows and do not show all features, if they do
not fit the screen width. We can call <code>print</code> and define how many rows
to show using parameter <code>n</code> and force print to show all features by
changing the <code>width</code> to infinity.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">iris</span>, n <span class="op">=</span> <span class="fl">3</span>, width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 150 × 5</span></span>
<span><span class="co">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span><span class="co">## 1          5.1         3.5          1.4         0.2 setosa </span></span>
<span><span class="co">## 2          4.9         3            1.4         0.2 setosa </span></span>
<span><span class="co">## 3          4.7         3.2          1.3         0.2 setosa </span></span>
<span><span class="co">## # ℹ 147 more rows</span></span></code></pre></div>
</div>
</div>
<div id="data-quality" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Data Quality<a class="anchor" aria-label="anchor" href="#data-quality"><i class="fas fa-link"></i></a>
</h2>
<p>Assessing the quality of the available data is crucial before we start
using the data. Start with summary statistics for each column to
identify outliers and missing values. The easiest way is to use the base R
function <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">##   Sepal.Length   Sepal.Width    Petal.Length   Petal.Width </span></span>
<span><span class="co">##  Min.   :4.30   Min.   :2.00   Min.   :1.00   Min.   :0.1  </span></span>
<span><span class="co">##  1st Qu.:5.10   1st Qu.:2.80   1st Qu.:1.60   1st Qu.:0.3  </span></span>
<span><span class="co">##  Median :5.80   Median :3.00   Median :4.35   Median :1.3  </span></span>
<span><span class="co">##  Mean   :5.84   Mean   :3.06   Mean   :3.76   Mean   :1.2  </span></span>
<span><span class="co">##  3rd Qu.:6.40   3rd Qu.:3.30   3rd Qu.:5.10   3rd Qu.:1.8  </span></span>
<span><span class="co">##  Max.   :7.90   Max.   :4.40   Max.   :6.90   Max.   :2.5  </span></span>
<span><span class="co">##        Species  </span></span>
<span><span class="co">##  setosa    :50  </span></span>
<span><span class="co">##  versicolor:50  </span></span>
<span><span class="co">##  virginica :50  </span></span>
<span><span class="co">##                 </span></span>
<span><span class="co">##                 </span></span>
<span><span class="co">## </span></span></code></pre></div>
<p>Feature names will be used in plots and analysis so having understandable
feature names is part of data quality.
Iris’s names are good but for most datasets, you may need to change
the names using either <code><a href="https://rdrr.io/r/base/colnames.html">rownames()</a></code>
or <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>.</p>
<p>You can also summarize
individual columns using tidyverse’s dplyr functions.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 1</span></span>
<span><span class="co">##    mean</span></span>
<span><span class="co">##   &lt;dbl&gt;</span></span>
<span><span class="co">## 1  5.84</span></span></code></pre></div>
<p>Using <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code>, multiple columns can be summarized. Un the following,
we calculate all numeric columns using the <code>mean</code> function.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 4</span></span>
<span><span class="co">##   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">## 1         5.84        3.06         3.76        1.20</span></span></code></pre></div>
<p>To find outliers or data problems, you need to look for very small
values (often a suspicious large number of zeros) using min and for
extremely large values using max. Comparing median and mean tells us if
the distribution is symmetric.</p>
<p>A visual method to inspect the data is to use a scatterplot matrix (we
use here <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs()</a></code> from package <code>GGally</code>). In this plot, we can
visually identify noise data points and outliers (points that are far
from the majority of other points).</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="co">## Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">##   method from   </span></span>
<span><span class="co">##   +.gg   ggplot2</span></span>
<span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-47-1.png" width="672"></div>
<p>This useful visualization combines many visualizations used to understand the
data and check for quality issues. Rows and columns are the features in the data.
We have also specified the aesthetic that we want to group each species using a different color.</p>
<ul>
<li><p>The visualizations in the diagonal panels show the
smoothed histograms with the distribution for each feature.
The plot tries to pick a good number of bins for the histogram
(see messages above). The distribution can be checked if it is close to normal,
unimodal or highly skewed. Also, we can see if the different groups are overlapping
or separable for each feature. For example, the three distributions for <code>Sepal.Width</code>
are almost identical meaning that it is hard to distinguish between
the different species using this feature alone. <code>Petal.Lenght</code> and <code>Petal.Width</code>
are much better.</p></li>
<li><p>The lower-left triangle panels contain scatterplots for all pairs features. These
are useful to see if there if features are correlated (the pearson correlation
coefficient if printed in the upper-right triangle). For example,
<code>Petal.Length</code> and <code>Petal.Width</code> are highly correlated overall
This makes sense since larger plants will have both longer and wider petals.
Inside the Setosa group this correlation it is a lot weaker.
We can also see if groups are
well separated using projections on two variables. Almost all panels show that
Setosa forms a point cloud well separated from the other two classes while
Versicolor and Virginica overlap.
We can also see outliers that are far from the other data points in its group.
See if you can spot the one red dot that is far away from all others.</p></li>
<li><p>The last row/column represents in this data set the class label Species.
It is a nominal variable so the plots are different. The bottom row panels
show (regular) histograms. The last column shows boxplots to represent
the distribution of the different features by group. Dots represent
outliers. Finally, the bottom-right panel contains the counts for the different
groups as a barplot. In this data set, each group has the same number of observations.</p></li>
</ul>
<p>Many data mining methods require complete data, that is the data cannot
contain missing values (<code>NA</code>). To remove missing values and duplicates
(identical data points which might be a mistake in the data), we often
do this:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean.data</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">clean.data</span><span class="op">)</span></span>
<span><span class="co">##   Sepal.Length   Sepal.Width    Petal.Length </span></span>
<span><span class="co">##  Min.   :4.30   Min.   :2.00   Min.   :1.00  </span></span>
<span><span class="co">##  1st Qu.:5.10   1st Qu.:2.80   1st Qu.:1.60  </span></span>
<span><span class="co">##  Median :5.80   Median :3.00   Median :4.30  </span></span>
<span><span class="co">##  Mean   :5.84   Mean   :3.06   Mean   :3.75  </span></span>
<span><span class="co">##  3rd Qu.:6.40   3rd Qu.:3.30   3rd Qu.:5.10  </span></span>
<span><span class="co">##  Max.   :7.90   Max.   :4.40   Max.   :6.90  </span></span>
<span><span class="co">##   Petal.Width         Species  </span></span>
<span><span class="co">##  Min.   :0.10   setosa    :50  </span></span>
<span><span class="co">##  1st Qu.:0.30   versicolor:50  </span></span>
<span><span class="co">##  Median :1.30   virginica :49  </span></span>
<span><span class="co">##  Mean   :1.19                  </span></span>
<span><span class="co">##  3rd Qu.:1.80                  </span></span>
<span><span class="co">##  Max.   :2.50</span></span></code></pre></div>
<p>The iris dataset has no missing values, but one non-unique case is gone
leaving only 149 flowers. Since only 1 out of 150 flowers in the dataset was
affected, results on the remaining data will give very similar results to the
complete data.</p>
<p>Typically, you should spend a lot more time on data cleaning.
It is important to always describe how you clean the data,
and how many objects are removed. You need to argue that conclusions based on
only the remaining data are still valid.</p>
</div>
<div id="data-preprocessing" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Data Preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"><i class="fas fa-link"></i></a>
</h2>
<div id="aggregation" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Aggregation<a class="anchor" aria-label="anchor" href="#aggregation"><i class="fas fa-link"></i></a>
</h3>
<p>Data often contains groups and we want to compare these groups. We group
the iris dataset by species and then calculate a summary statistic for
each group.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 3 × 5</span></span>
<span><span class="co">##   Species  Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">##   &lt;fct&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">## 1 setosa           5.01        3.43         1.46       0.246</span></span>
<span><span class="co">## 2 versico…         5.94        2.77         4.26       1.33 </span></span>
<span><span class="co">## 3 virgini…         6.59        2.97         5.55       2.03</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">median</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 3 × 5</span></span>
<span><span class="co">##   Species  Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">##   &lt;fct&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">## 1 setosa            5           3.4         1.5          0.2</span></span>
<span><span class="co">## 2 versico…          5.9         2.8         4.35         1.3</span></span>
<span><span class="co">## 3 virgini…          6.5         3           5.55         2</span></span></code></pre></div>
<p>Using this information, we can compare how features differ between
groups.</p>
</div>
<div id="sampling" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Sampling<a class="anchor" aria-label="anchor" href="#sampling"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://en.wikipedia.org/wiki/Sampling_(statistics)">Sampling</a> is often
used in data mining to reduce the dataset size before modeling or
visualization.</p>
<div id="random-sampling" class="section level4" number="2.3.2.1">
<h4>
<span class="header-section-number">2.3.2.1</span> Random Sampling<a class="anchor" aria-label="anchor" href="#random-sampling"><i class="fas fa-link"></i></a>
</h4>
<p>The built-in sample function can sample from a vector. Here we sample
with replacement.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">##  [1] "C" "A" "B" "C" "B" "C" "A" "A" "B" "C"</span></span></code></pre></div>
<p>We often want to sample rows from a dataset. This can be done by
sampling without replacement from a vector with row indices (using the
functions <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code> and <code><a href="https://rdrr.io/r/base/nrow.html">nrow()</a></code>). The sample vector is then used to
subset the rows of the dataset.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">take</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">take</span></span>
<span><span class="co">##  [1]  46  42  37 120  78  31  13 114  80  72 109  45  59 139</span></span>
<span><span class="co">## [15]  67</span></span>
<span><span class="va">iris</span><span class="op">[</span><span class="va">take</span>, <span class="op">]</span></span>
<span><span class="co">## # A tibble: 15 × 5</span></span>
<span><span class="co">##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span><span class="co">##  1          4.8         3            1.4         0.3 setosa </span></span>
<span><span class="co">##  2          4.5         2.3          1.3         0.3 setosa </span></span>
<span><span class="co">##  3          5.5         3.5          1.3         0.2 setosa </span></span>
<span><span class="co">##  4          6           2.2          5           1.5 virgin…</span></span>
<span><span class="co">##  5          6.7         3            5           1.7 versic…</span></span>
<span><span class="co">##  6          4.8         3.1          1.6         0.2 setosa </span></span>
<span><span class="co">##  7          4.8         3            1.4         0.1 setosa </span></span>
<span><span class="co">##  8          5.7         2.5          5           2   virgin…</span></span>
<span><span class="co">##  9          5.7         2.6          3.5         1   versic…</span></span>
<span><span class="co">## 10          6.1         2.8          4           1.3 versic…</span></span>
<span><span class="co">## 11          6.7         2.5          5.8         1.8 virgin…</span></span>
<span><span class="co">## 12          5.1         3.8          1.9         0.4 setosa </span></span>
<span><span class="co">## 13          6.6         2.9          4.6         1.3 versic…</span></span>
<span><span class="co">## 14          6           3            4.8         1.8 virgin…</span></span>
<span><span class="co">## 15          5.6         3            4.5         1.5 versic…</span></span></code></pre></div>
<p><code>dplyr</code> from tidyverse lets us sample rows from tibbles directly using
<code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample()</a></code>. I set the random number generator seed to make the
results reproducible.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">s</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span></code></pre></div>
<p><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-52-1.png" width="672">
Instead of <code>n</code> you can also specify the proportion of rows to select using
<code>prob</code>.</p>
</div>
<div id="stratified-sampling" class="section level4" number="2.3.2.2">
<h4>
<span class="header-section-number">2.3.2.2</span> Stratified Sampling<a class="anchor" aria-label="anchor" href="#stratified-sampling"><i class="fas fa-link"></i></a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/Stratified_sampling">Stratified sampling</a>
is a method of sampling from a population which can be partitioned into
subpopulations, while controlling the proportions of the subpopulation
in the resulting sample.</p>
<p>In the following, the subpopulations are the different types of species
and we want to make sure to sample the same number (5) flowers from
each. This can be achieved by first grouping the data by species and
then sampling a number of flowers from each group.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">s2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">## `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-53-1.png" width="672"></div>
<p>More sophisticated sampling procedures are implemented in the package
<code>sampling</code>.</p>
</div>
</div>
<div id="dimensionality-reduction" class="section level3" number="2.3.3">
<h3>
<span class="header-section-number">2.3.3</span> Dimensionality Reduction<a class="anchor" aria-label="anchor" href="#dimensionality-reduction"><i class="fas fa-link"></i></a>
</h3>
<p>The number of features is often called the dimensional of the data following the
idea that each feature (at least the numeric features) can be seen as an axis of the data.
High-dimensional data is harder to analyze by the user (e.g., visualize).
It also is problematic for many data mining algorithms since it requires more memory
and computational resources.</p>
<p><a href="https://en.wikipedia.org/wiki/Dimensionality_reduction">Dimensionality reduction</a>
tries to represent high-dimensional data in a low-dimensional space so that the
low-dimensional representation retains some meaningful properties (e.g., information about similarity or distances) of the original data. Dimensionality reduction is
used for visualization and as a prepossessing technique before using other
data mining methods like clustering and classification.</p>
<p>Recently, data embeddings using artificial neural networks have become very popular.
These approaches can not only reduce the dimensionality of the data, but
learn a better representation of various kinds of data (e.g., text). As such
these approaches can be seen as automatically engineering features from the
high-dimensional original data.</p>
<div id="principal-components-analysis-pca" class="section level4" number="2.3.3.1">
<h4>
<span class="header-section-number">2.3.3.1</span> Principal Components Analysis (PCA)<a class="anchor" aria-label="anchor" href="#principal-components-analysis-pca"><i class="fas fa-link"></i></a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a>
calculates principal components (a set of new orthonormal basis vectors
in the data space) from data points such that the first principal
component explains the most variability in the data, the second the next
most and so on. In data analysis, PCA is used to project
high-dimensional data points onto the first few (typically two)
principal components for visualization as a scatter plot and as
preprocessing for modeling (e.g., before k-means clustering). Points
that are closer together in the high-dimensional original space, tend
also be closer together when projected into the lower-dimensional space,</p>
<p>We can use an interactive 3-d plot (from package <code>plotly</code>) to look at
three of the four dimensions of the iris dataset. Note that it is hard
to visualize more than 3 dimensions.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span><span class="va">iris</span>, </span>
<span>                x <span class="op">=</span> <span class="op">~</span><span class="va">Sepal.Length</span>, </span>
<span>                y <span class="op">=</span> <span class="op">~</span><span class="va">Petal.Length</span>, </span>
<span>                z <span class="op">=</span> <span class="op">~</span><span class="va">Sepal.Width</span>, </span>
<span>      color <span class="op">=</span> <span class="op">~</span><span class="va">Species</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_markers</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-99b97bb611245f5d32af" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-99b97bb611245f5d32af">{"x":{"visdat":{"a09b2c01a07c":["function () ","plotlyVisDat"]},"cur_data":"a09b2c01a07c","attrs":{"a09b2c01a07c":{"x":{},"y":{},"z":{},"color":{},"size":1,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Sepal.Length"},"yaxis":{"title":"Petal.Length"},"zaxis":{"title":"Sepal.Width"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[5.0999999999999996,4.9000000000000004,4.7000000000000002,4.5999999999999996,5,5.4000000000000004,4.5999999999999996,5,4.4000000000000004,4.9000000000000004,5.4000000000000004,4.7999999999999998,4.7999999999999998,4.2999999999999998,5.7999999999999998,5.7000000000000002,5.4000000000000004,5.0999999999999996,5.7000000000000002,5.0999999999999996,5.4000000000000004,5.0999999999999996,4.5999999999999996,5.0999999999999996,4.7999999999999998,5,5,5.2000000000000002,5.2000000000000002,4.7000000000000002,4.7999999999999998,5.4000000000000004,5.2000000000000002,5.5,4.9000000000000004,5,5.5,4.9000000000000004,4.4000000000000004,5.0999999999999996,5,4.5,4.4000000000000004,5,5.0999999999999996,4.7999999999999998,5.0999999999999996,4.5999999999999996,5.2999999999999998,5],"y":[1.3999999999999999,1.3999999999999999,1.3,1.5,1.3999999999999999,1.7,1.3999999999999999,1.5,1.3999999999999999,1.5,1.5,1.6000000000000001,1.3999999999999999,1.1000000000000001,1.2,1.5,1.3,1.3999999999999999,1.7,1.5,1.7,1.5,1,1.7,1.8999999999999999,1.6000000000000001,1.6000000000000001,1.5,1.3999999999999999,1.6000000000000001,1.6000000000000001,1.5,1.5,1.3999999999999999,1.5,1.2,1.3,1.3999999999999999,1.3,1.5,1.3,1.3,1.3,1.6000000000000001,1.8999999999999999,1.3999999999999999,1.6000000000000001,1.3999999999999999,1.5,1.3999999999999999],"z":[3.5,3,3.2000000000000002,3.1000000000000001,3.6000000000000001,3.8999999999999999,3.3999999999999999,3.3999999999999999,2.8999999999999999,3.1000000000000001,3.7000000000000002,3.3999999999999999,3,3,4,4.4000000000000004,3.8999999999999999,3.5,3.7999999999999998,3.7999999999999998,3.3999999999999999,3.7000000000000002,3.6000000000000001,3.2999999999999998,3.3999999999999999,3,3.3999999999999999,3.5,3.3999999999999999,3.2000000000000002,3.1000000000000001,3.3999999999999999,4.0999999999999996,4.2000000000000002,3.1000000000000001,3.2000000000000002,3.5,3.6000000000000001,3,3.3999999999999999,3.5,2.2999999999999998,3.2000000000000002,3.5,3.7999999999999998,3,3.7999999999999998,3.2000000000000002,3.7000000000000002,3.2999999999999998],"type":"scatter3d","mode":"markers","name":"setosa","marker":{"color":"rgba(102,194,165,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)","size":55},"error_y":{"color":"rgba(102,194,165,1)","width":55},"error_x":{"color":"rgba(102,194,165,1)","width":55},"line":{"color":"rgba(102,194,165,1)","width":55},"frame":null},{"x":[7,6.4000000000000004,6.9000000000000004,5.5,6.5,5.7000000000000002,6.2999999999999998,4.9000000000000004,6.5999999999999996,5.2000000000000002,5,5.9000000000000004,6,6.0999999999999996,5.5999999999999996,6.7000000000000002,5.5999999999999996,5.7999999999999998,6.2000000000000002,5.5999999999999996,5.9000000000000004,6.0999999999999996,6.2999999999999998,6.0999999999999996,6.4000000000000004,6.5999999999999996,6.7999999999999998,6.7000000000000002,6,5.7000000000000002,5.5,5.5,5.7999999999999998,6,5.4000000000000004,6,6.7000000000000002,6.2999999999999998,5.5999999999999996,5.5,5.5,6.0999999999999996,5.7999999999999998,5,5.5999999999999996,5.7000000000000002,5.7000000000000002,6.2000000000000002,5.0999999999999996,5.7000000000000002],"y":[4.7000000000000002,4.5,4.9000000000000004,4,4.5999999999999996,4.5,4.7000000000000002,3.2999999999999998,4.5999999999999996,3.8999999999999999,3.5,4.2000000000000002,4,4.7000000000000002,3.6000000000000001,4.4000000000000004,4.5,4.0999999999999996,4.5,3.8999999999999999,4.7999999999999998,4,4.9000000000000004,4.7000000000000002,4.2999999999999998,4.4000000000000004,4.7999999999999998,5,4.5,3.5,3.7999999999999998,3.7000000000000002,3.8999999999999999,5.0999999999999996,4.5,4.5,4.7000000000000002,4.4000000000000004,4.0999999999999996,4,4.4000000000000004,4.5999999999999996,4,3.2999999999999998,4.2000000000000002,4.2000000000000002,4.2000000000000002,4.2999999999999998,3,4.0999999999999996],"z":[3.2000000000000002,3.2000000000000002,3.1000000000000001,2.2999999999999998,2.7999999999999998,2.7999999999999998,3.2999999999999998,2.3999999999999999,2.8999999999999999,2.7000000000000002,2,3,2.2000000000000002,2.8999999999999999,2.8999999999999999,3.1000000000000001,3,2.7000000000000002,2.2000000000000002,2.5,3.2000000000000002,2.7999999999999998,2.5,2.7999999999999998,2.8999999999999999,3,2.7999999999999998,3,2.8999999999999999,2.6000000000000001,2.3999999999999999,2.3999999999999999,2.7000000000000002,2.7000000000000002,3,3.3999999999999999,3.1000000000000001,2.2999999999999998,3,2.5,2.6000000000000001,3,2.6000000000000001,2.2999999999999998,2.7000000000000002,3,2.8999999999999999,2.8999999999999999,2.5,2.7999999999999998],"type":"scatter3d","mode":"markers","name":"versicolor","marker":{"color":"rgba(252,141,98,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":55},"error_y":{"color":"rgba(252,141,98,1)","width":55},"error_x":{"color":"rgba(252,141,98,1)","width":55},"line":{"color":"rgba(252,141,98,1)","width":55},"frame":null},{"x":[6.2999999999999998,5.7999999999999998,7.0999999999999996,6.2999999999999998,6.5,7.5999999999999996,4.9000000000000004,7.2999999999999998,6.7000000000000002,7.2000000000000002,6.5,6.4000000000000004,6.7999999999999998,5.7000000000000002,5.7999999999999998,6.4000000000000004,6.5,7.7000000000000002,7.7000000000000002,6,6.9000000000000004,5.5999999999999996,7.7000000000000002,6.2999999999999998,6.7000000000000002,7.2000000000000002,6.2000000000000002,6.0999999999999996,6.4000000000000004,7.2000000000000002,7.4000000000000004,7.9000000000000004,6.4000000000000004,6.2999999999999998,6.0999999999999996,7.7000000000000002,6.2999999999999998,6.4000000000000004,6,6.9000000000000004,6.7000000000000002,6.9000000000000004,5.7999999999999998,6.7999999999999998,6.7000000000000002,6.7000000000000002,6.2999999999999998,6.5,6.2000000000000002,5.9000000000000004],"y":[6,5.0999999999999996,5.9000000000000004,5.5999999999999996,5.7999999999999998,6.5999999999999996,4.5,6.2999999999999998,5.7999999999999998,6.0999999999999996,5.0999999999999996,5.2999999999999998,5.5,5,5.0999999999999996,5.2999999999999998,5.5,6.7000000000000002,6.9000000000000004,5,5.7000000000000002,4.9000000000000004,6.7000000000000002,4.9000000000000004,5.7000000000000002,6,4.7999999999999998,4.9000000000000004,5.5999999999999996,5.7999999999999998,6.0999999999999996,6.4000000000000004,5.5999999999999996,5.0999999999999996,5.5999999999999996,6.0999999999999996,5.5999999999999996,5.5,4.7999999999999998,5.4000000000000004,5.5999999999999996,5.0999999999999996,5.0999999999999996,5.9000000000000004,5.7000000000000002,5.2000000000000002,5,5.2000000000000002,5.4000000000000004,5.0999999999999996],"z":[3.2999999999999998,2.7000000000000002,3,2.8999999999999999,3,3,2.5,2.8999999999999999,2.5,3.6000000000000001,3.2000000000000002,2.7000000000000002,3,2.5,2.7999999999999998,3.2000000000000002,3,3.7999999999999998,2.6000000000000001,2.2000000000000002,3.2000000000000002,2.7999999999999998,2.7999999999999998,2.7000000000000002,3.2999999999999998,3.2000000000000002,2.7999999999999998,3,2.7999999999999998,3,2.7999999999999998,3.7999999999999998,2.7999999999999998,2.7999999999999998,2.6000000000000001,3,3.3999999999999999,3.1000000000000001,3,3.1000000000000001,3.1000000000000001,3.1000000000000001,2.7000000000000002,3.2000000000000002,3.2999999999999998,3,2.5,3,3.3999999999999999,3],"type":"scatter3d","mode":"markers","name":"virginica","marker":{"color":"rgba(141,160,203,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)","size":55},"error_y":{"color":"rgba(141,160,203,1)","width":55},"error_x":{"color":"rgba(141,160,203,1)","width":55},"line":{"color":"rgba(141,160,203,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The principal components can be calculated from a matrix using the
function <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code>. We select all numeric columns (by unselecting the
species column) and convert the tibble into a matrix before the
calculation.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span></span>
<span><span class="co">## Importance of components:</span></span>
<span><span class="co">##                          PC1    PC2    PC3     PC4</span></span>
<span><span class="co">## Standard deviation     2.056 0.4926 0.2797 0.15439</span></span>
<span><span class="co">## Proportion of Variance 0.925 0.0531 0.0171 0.00521</span></span>
<span><span class="co">## Cumulative Proportion  0.925 0.9777 0.9948 1.00000</span></span></code></pre></div>
<p>How important is each principal component can also be seen using a
<a href="https://en.wikipedia.org/wiki/Scree_plot">scree plot</a>. The plot
function for the result of the <code>prcomp</code> function visualizes how much
variability in the data is explained by each additional principal
component.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pc</span>, type <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-57-1.png" width="672"></div>
<p>Note that the first principal component (PC1) explains most of the
variability in the iris dataset.</p>
<p>To find out what information is stored in the object <code>pc</code>, we can
inspect the raw object (display <em>str</em>ucture).</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span></span>
<span><span class="co">## List of 5</span></span>
<span><span class="co">##  $ sdev    : num [1:4] 2.056 0.493 0.28 0.154</span></span>
<span><span class="co">##  $ rotation: num [1:4, 1:4] 0.3614 -0.0845 0.8567 0.3583 -0.6566 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span></span>
<span><span class="co">##   .. ..$ : chr [1:4] "PC1" "PC2" "PC3" "PC4"</span></span>
<span><span class="co">##  $ center  : Named num [1:4] 5.84 3.06 3.76 1.2</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span></span>
<span><span class="co">##  $ scale   : logi FALSE</span></span>
<span><span class="co">##  $ x       : num [1:150, 1:4] -2.68 -2.71 -2.89 -2.75 -2.73 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : NULL</span></span>
<span><span class="co">##   .. ..$ : chr [1:4] "PC1" "PC2" "PC3" "PC4"</span></span>
<span><span class="co">##  - attr(*, "class")= chr "prcomp"</span></span></code></pre></div>
<p>The object <code>pc</code> (like most objects in R) is a list with a class
attribute. The list element <code>x</code> contains the data points projected on
the principal components. We can convert the matrix into a tibble and
add the species column from the original dataset back (since the rows
are in the same order), and then display the data projected on the first
two principal components.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Species <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris_projected</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-59-1.png" width="672"></div>
<p>Flowers that are displayed close together in this projection are also
close together in the original 4-dimensional space. Since the first
principal component represents most of the variability, we can also show
the data projected only on PC1.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris_projected</span>, </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-60-1.png" width="672"></div>
<p>We see that we can perfectly separate the species Setosa using just the
first principal component. The other two species are harder to separate.</p>
<p>A plot of the projected data with the original axes added as arrows is
called a <a href="https://en.wikipedia.org/wiki/Biplot">biplot</a>. If the arrows
(original axes) align roughly with the axes of the projection, then they
are correlated (linearly dependent).</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-61-1.png" width="672"></div>
<p>We can also display only the old and new axes.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-62-1.png" width="672"></div>
<p>We see Petal.Width and Petal.Length point in the same direction which
indicates that they are highly correlated. They are also roughly aligned
with PC1 (called Dim1 in the plot) which means that PC1 represents most
of the variability of these two variables. Sepal.Width is almost aligned
with the y-axis and therefore it is represented by PC2 (Dim2).
Petal.Width/Petal.Length and Sepal.Width are almost at 90 degrees,
indicating that they are close to uncorrelated. Sepal.Length is
correlated to all other variables and represented by both, PC1 and PC2
in the projection.</p>
</div>
<div id="multi-dimensional-scaling-mds" class="section level4" number="2.3.3.2">
<h4>
<span class="header-section-number">2.3.3.2</span> Multi-Dimensional Scaling (MDS)<a class="anchor" aria-label="anchor" href="#multi-dimensional-scaling-mds"><i class="fas fa-link"></i></a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/Multidimensional_scaling">MDS</a> is similar
to PCA. Instead of data points, it starts with pairwise distances (i.e.,
a distance matrix) and produces a space where points are placed to
represent these distances as well as possible. The axes in this space
are called components and are similar to the principal components in
PCA.</p>
<p>First, we calculate a distance matrix (Euclidean distances) from the 4-d
space of the iris dataset.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Metric (classic) MDS tries to construct a space where points with lower
distances are placed closer together. We project the data represented by
a distance matrix on <code>k = 2</code> dimensions.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">d</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"comp1"</span>, <span class="st">"comp2"</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Species <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comp1</span>, y <span class="op">=</span> <span class="va">comp2</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-64-1.png" width="672"></div>
<p>The resulting projection is similar (except for rotation and reflection)
to the result of the projection using PCA.</p>
</div>
<div id="non-parametric-multidimensional-scaling" class="section level4" number="2.3.3.3">
<h4>
<span class="header-section-number">2.3.3.3</span> Non-Parametric Multidimensional Scaling<a class="anchor" aria-label="anchor" href="#non-parametric-multidimensional-scaling"><i class="fas fa-link"></i></a>
</h4>
<p>Non-parametric multidimensional scaling performs MDS while relaxing the
need of linear relationships. Methods are available in package <code>MASS</code> as
functions <code>isoMDS()</code> (implements <a href="https://en.wikipedia.org/wiki/Isomap">isoMAP</a>) and <code>sammon()</code>.</p>
</div>
<div id="embeddings-nonlinear-dimensionality-reduction-methods" class="section level4" number="2.3.3.4">
<h4>
<span class="header-section-number">2.3.3.4</span> Embeddings: Nonlinear Dimensionality Reduction Methods<a class="anchor" aria-label="anchor" href="#embeddings-nonlinear-dimensionality-reduction-methods"><i class="fas fa-link"></i></a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction">Nonlinear dimensionality reduction</a>
is also called manifold learning or creating a low-dimensional embedding.
These methods have become very popular to support visualizing high-dimensional data,
mine text by converting words into numeric vectors that can be used as features in models,
and as a method to automatically create features for data mining models by finding an efficient
representation. Popular methods are:</p>
<ul>
<li>
<p>Visualization: <a href="https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding">t-distributed stochastic neighbor embedding</a>
(<code>Rtsne()</code> in package <code>Rtsne</code>) and uniform manifold approximation and projection
(<code>umap()</code> in package <code>umap</code>) are used
for projecting data to 2 dimensions for visualization. Here is an example of
embedding the 4-dimensional iris data using tsne. The embedding algorithm
requires unique data points.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_distinct</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, </span>
<span>                                  <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span>, </span>
<span>                                  .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tsne</span> <span class="op">&lt;-</span> <span class="fu">Rtsne</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rtsne/man/Rtsne.html">Rtsne</a></span><span class="op">(</span><span class="va">iris_distinct</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">emb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">tsne</span><span class="op">$</span><span class="va">Y</span>, Species <span class="op">=</span> <span class="va">iris_distinct</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">emb</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-65-1.png" width="672"></div>
<p>We see that the embedding separates the class Setosa very well from the other
two species indicating that the flowers are very different.</p>
</li>
<li><p>Text mining: <a href="https://en.wikipedia.org/wiki/Word2vec">Word2vec</a> (<code>word2vec()</code> in
<code>word2vec</code>) is used in <a href="https://cran.r-project.org/web/views/NaturalLanguageProcessing.html">natural language processing</a>
to convert words to numeric vectors that represent similarities between words.
These vectors can be used as features for data mining models for clustering
and classification. Other popular methods for text embedding are
<a href="https://nlp.stanford.edu/projects/glove/">GloVe</a> and
<a href="https://en.wikipedia.org/wiki/BERT_(language_model)">BERT</a>.</p></li>
<li><p>Representation learning: <a href="https://en.wikipedia.org/wiki/Autoencoder">Autoencoders</a>
are artificial neural networks used to learn an efficient representation (encoding)
for a set of data by minimizing the reconstruction error. This new representation
can be seen as a way to automatically creating features that describe the
important characteristics of the data while reducing noise. This representation
often helps models to learn better.
In R, autoencoders are typically created using
the <a href="https://keras3.posit.co/"><code>keras</code> package</a>. Creating an
autoencoder requires some work. You will
need to decide on the network topology and have sufficient training data.</p></li>
</ul>
</div>
</div>
<div id="feature-subset-selection" class="section level3" number="2.3.4">
<h3>
<span class="header-section-number">2.3.4</span> Feature Subset Selection<a class="anchor" aria-label="anchor" href="#feature-subset-selection"><i class="fas fa-link"></i></a>
</h3>
<p>Feature selection is the process of identifying the features that are
used to create a model. We will talk about feature selection when we
discuss classification models in Chapter 3 in <a href="classification-basic-concepts.html#feature-selection">Feature Selection*</a>.</p>
</div>
<div id="discretization" class="section level3" number="2.3.5">
<h3>
<span class="header-section-number">2.3.5</span> Discretization<a class="anchor" aria-label="anchor" href="#discretization"><i class="fas fa-link"></i></a>
</h3>
<p>Some data mining methods require discrete data. Discretization converts
continuous features into discrete features. As an example, we will
discretize the continuous feature Petal.Width. Before we perform
discretization, we should look at the distribution and see if it gives
us an idea how we should group the continuous values into a set of
discrete values. A histogram visualizes the distribution of a single
continuous feature.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-66-1.png" width="672"></div>
<p>The bins in the histogram represent a discretization using a fixed bin
width. The R function <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> performs equal interval width
discretization creating a vector of type <code>factor</code> where each level
represents an interval.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Sepal.Width</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">##   [1] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">##   [6] (3.6,4.4] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">##  [11] (3.6,4.4] (2.8,3.6] (2.8,3.6] (2.8,3.6] (3.6,4.4]</span></span>
<span><span class="co">##  [16] (3.6,4.4] (3.6,4.4] (2.8,3.6] (3.6,4.4] (3.6,4.4]</span></span>
<span><span class="co">##  [21] (2.8,3.6] (3.6,4.4] (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">##  [26] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">##  [31] (2.8,3.6] (2.8,3.6] (3.6,4.4] (3.6,4.4] (2.8,3.6]</span></span>
<span><span class="co">##  [36] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">##  [41] (2.8,3.6] (2,2.8]   (2.8,3.6] (2.8,3.6] (3.6,4.4]</span></span>
<span><span class="co">##  [46] (2.8,3.6] (3.6,4.4] (2.8,3.6] (3.6,4.4] (2.8,3.6]</span></span>
<span><span class="co">##  [51] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2,2.8]   (2,2.8]  </span></span>
<span><span class="co">##  [56] (2,2.8]   (2.8,3.6] (2,2.8]   (2.8,3.6] (2,2.8]  </span></span>
<span><span class="co">##  [61] (2,2.8]   (2.8,3.6] (2,2.8]   (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">##  [66] (2.8,3.6] (2.8,3.6] (2,2.8]   (2,2.8]   (2,2.8]  </span></span>
<span><span class="co">##  [71] (2.8,3.6] (2,2.8]   (2,2.8]   (2,2.8]   (2.8,3.6]</span></span>
<span><span class="co">##  [76] (2.8,3.6] (2,2.8]   (2.8,3.6] (2.8,3.6] (2,2.8]  </span></span>
<span><span class="co">##  [81] (2,2.8]   (2,2.8]   (2,2.8]   (2,2.8]   (2.8,3.6]</span></span>
<span><span class="co">##  [86] (2.8,3.6] (2.8,3.6] (2,2.8]   (2.8,3.6] (2,2.8]  </span></span>
<span><span class="co">##  [91] (2,2.8]   (2.8,3.6] (2,2.8]   (2,2.8]   (2,2.8]  </span></span>
<span><span class="co">##  [96] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2,2.8]   (2,2.8]  </span></span>
<span><span class="co">## [101] (2.8,3.6] (2,2.8]   (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">## [106] (2.8,3.6] (2,2.8]   (2.8,3.6] (2,2.8]   (2.8,3.6]</span></span>
<span><span class="co">## [111] (2.8,3.6] (2,2.8]   (2.8,3.6] (2,2.8]   (2,2.8]  </span></span>
<span><span class="co">## [116] (2.8,3.6] (2.8,3.6] (3.6,4.4] (2,2.8]   (2,2.8]  </span></span>
<span><span class="co">## [121] (2.8,3.6] (2,2.8]   (2,2.8]   (2,2.8]   (2.8,3.6]</span></span>
<span><span class="co">## [126] (2.8,3.6] (2,2.8]   (2.8,3.6] (2,2.8]   (2.8,3.6]</span></span>
<span><span class="co">## [131] (2,2.8]   (3.6,4.4] (2,2.8]   (2,2.8]   (2,2.8]  </span></span>
<span><span class="co">## [136] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">## [141] (2.8,3.6] (2.8,3.6] (2,2.8]   (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">## [146] (2.8,3.6] (2,2.8]   (2.8,3.6] (2.8,3.6] (2.8,3.6]</span></span>
<span><span class="co">## Levels: (2,2.8] (2.8,3.6] (3.6,4.4]</span></span></code></pre></div>
<p>Other discretization methods include equal frequency discretization or
using k-means clustering. These methods are implemented by several R
packages. We use here the implementation in package <code>arules</code> and
visualize the results as histograms with blue lines to separate
intervals assigned to each discrete value.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/arules">arules</a></span><span class="op">)</span></span>
<span><span class="co">## Loading required package: Matrix</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'Matrix'</span></span>
<span><span class="co">## The following objects are masked from 'package:tidyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     expand, pack, unpack</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'arules'</span></span>
<span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     recode</span></span>
<span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     abbreviate, write</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/arules/man/discretize.html">discretize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"interval"</span>, breaks <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">##   [1] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##   [6] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [11] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [16] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [21] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [26] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [31] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [36] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [41] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [46] [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9) [0.1,0.9)</span></span>
<span><span class="co">##  [51] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [56] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [61] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [66] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [71] [1.7,2.5] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [76] [0.9,1.7) [0.9,1.7) [1.7,2.5] [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [81] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [86] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [91] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">##  [96] [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">## [101] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5]</span></span>
<span><span class="co">## [106] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5]</span></span>
<span><span class="co">## [111] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5]</span></span>
<span><span class="co">## [116] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [0.9,1.7)</span></span>
<span><span class="co">## [121] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5]</span></span>
<span><span class="co">## [126] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [0.9,1.7)</span></span>
<span><span class="co">## [131] [1.7,2.5] [1.7,2.5] [1.7,2.5] [0.9,1.7) [0.9,1.7)</span></span>
<span><span class="co">## [136] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5]</span></span>
<span><span class="co">## [141] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5]</span></span>
<span><span class="co">## [146] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5] [1.7,2.5]</span></span>
<span><span class="co">## attr(,"discretized:breaks")</span></span>
<span><span class="co">## [1] 0.1 0.9 1.7 2.5</span></span>
<span><span class="co">## attr(,"discretized:method")</span></span>
<span><span class="co">## [1] interval</span></span>
<span><span class="co">## Levels: [0.1,0.9) [0.9,1.7) [1.7,2.5]</span></span></code></pre></div>
<p>To show the differences between the methods, we use the three
discretization methods and draw blue lines in the histogram to show
how they cut the data.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>      xintercept <span class="op">=</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/arules/man/discretize.html">discretize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"interval"</span>, breaks <span class="op">=</span> <span class="fl">3</span>, onlycuts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Discretization: interval"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"Blue lines are discretization boundaries"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-69-1.png" width="672"></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/arules/man/discretize.html">discretize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"frequency"</span>, breaks <span class="op">=</span> <span class="fl">3</span>, onlycuts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>   color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Discretization: frequency"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"Blue lines are discretization boundaries"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-69-2.png" width="672"></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/arules/man/discretize.html">discretize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cluster"</span>, breaks <span class="op">=</span> <span class="fl">3</span>, onlycuts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>   color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Discretization: cluster"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"Blue lines are discretization boundaries"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-69-3.png" width="672"></div>
<p>The user needs to decide on the number of intervals and the used method.</p>
</div>
<div id="variable-transformation-standardization" class="section level3" number="2.3.6">
<h3>
<span class="header-section-number">2.3.6</span> Variable Transformation: Standardization<a class="anchor" aria-label="anchor" href="#variable-transformation-standardization"><i class="fas fa-link"></i></a>
</h3>
<p>Standardizing (scaling, normalizing) the range of features values is
important to make them comparable. The most popular method is to convert
the values of each feature to
<a href="https://en.wikipedia.org/wiki/Standard_score">z-scores</a>. by subtracting
the mean (centering) and dividing by the standard deviation (scaling).
The standardized feature will have a mean of zero and are measured in
standard deviations from the mean. Positive values indicate how many
standard deviation the original feature value was above the average.
Negative standardized values indicate below-average values.</p>
<p>R-base provides the function <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> to standardize the columns in a data.frame. Tidyverse currently does not have a simple scale function, so we
make one It mutates all numeric columns using an anonymous function
that calculates the z-score.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scale_numeric</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>  <span class="va">x</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, </span>
<span>                <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris.scaled</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">scale_numeric</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">iris.scaled</span></span>
<span><span class="co">## # A tibble: 150 × 5</span></span>
<span><span class="co">##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span><span class="co">##  1       -0.898      1.02          -1.34       -1.31 setosa </span></span>
<span><span class="co">##  2       -1.14      -0.132         -1.34       -1.31 setosa </span></span>
<span><span class="co">##  3       -1.38       0.327         -1.39       -1.31 setosa </span></span>
<span><span class="co">##  4       -1.50       0.0979        -1.28       -1.31 setosa </span></span>
<span><span class="co">##  5       -1.02       1.25          -1.34       -1.31 setosa </span></span>
<span><span class="co">##  6       -0.535      1.93          -1.17       -1.05 setosa </span></span>
<span><span class="co">##  7       -1.50       0.786         -1.34       -1.18 setosa </span></span>
<span><span class="co">##  8       -1.02       0.786         -1.28       -1.31 setosa </span></span>
<span><span class="co">##  9       -1.74      -0.361         -1.34       -1.31 setosa </span></span>
<span><span class="co">## 10       -1.14       0.0979        -1.28       -1.44 setosa </span></span>
<span><span class="co">## # ℹ 140 more rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">iris.scaled</span><span class="op">)</span></span>
<span><span class="co">##   Sepal.Length      Sepal.Width      Petal.Length   </span></span>
<span><span class="co">##  Min.   :-1.8638   Min.   :-2.426   Min.   :-1.562  </span></span>
<span><span class="co">##  1st Qu.:-0.8977   1st Qu.:-0.590   1st Qu.:-1.222  </span></span>
<span><span class="co">##  Median :-0.0523   Median :-0.132   Median : 0.335  </span></span>
<span><span class="co">##  Mean   : 0.0000   Mean   : 0.000   Mean   : 0.000  </span></span>
<span><span class="co">##  3rd Qu.: 0.6722   3rd Qu.: 0.557   3rd Qu.: 0.760  </span></span>
<span><span class="co">##  Max.   : 2.4837   Max.   : 3.080   Max.   : 1.780  </span></span>
<span><span class="co">##   Petal.Width           Species  </span></span>
<span><span class="co">##  Min.   :-1.442   setosa    :50  </span></span>
<span><span class="co">##  1st Qu.:-1.180   versicolor:50  </span></span>
<span><span class="co">##  Median : 0.132   virginica :50  </span></span>
<span><span class="co">##  Mean   : 0.000                  </span></span>
<span><span class="co">##  3rd Qu.: 0.788                  </span></span>
<span><span class="co">##  Max.   : 1.706</span></span></code></pre></div>
<p>The standardized feature has a mean of zero and most “normal” values
will fall in the range <span class="math inline">\([-3,3]\)</span> and is measured in standard deviations from the average.
Negative values mean smaller than the average and positive values mean larger than the average.</p>
</div>
</div>
<div id="measures-of-similarity-and-dissimilarity" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Measures of Similarity and Dissimilarity<a class="anchor" aria-label="anchor" href="#measures-of-similarity-and-dissimilarity"><i class="fas fa-link"></i></a>
</h2>
<p>Proximities help with quantifying how similar two objects are.
<a href="https://en.wikipedia.org/wiki/Similarity_(geometry)">Similariy</a> is a concept from geometry.
The best-known
way to define similarity is Euclidean distance, but proximities can be measured in
different ways depending on the information we have about the objects.</p>
<p>R stores proximity as dissimilarities/distances matrices. Similarities
are first converted to dissimilarities. Distances are symmetric, i.e.,
the distance from A to B is the same as the distance from B to A. R
therefore stores only a triangle (typically the lower triangle) of the
distance matrix.</p>
<div id="minkowsky-distances" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Minkowsky Distances<a class="anchor" aria-label="anchor" href="#minkowsky-distances"><i class="fas fa-link"></i></a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Minkowski_distance">Minkowsky
distance</a> is a family
of distances including Euclidean and Manhattan distance. It is defined
between two feature vectors <span class="math inline">\(\mathbf{x} = (x_1, x_2, ..., x_n)\)</span> and
<span class="math inline">\(\mathbf{y} = (y_1, y_2, ..., y_n)\)</span> as</p>
<p><span class="math display">\[
d(\mathbf{x},\mathbf{y}) = \left(\sum_{i=1}^n |x_i - y_i|^p\right)^{\frac{1}{p}} = ||\mathbf{x}-\mathbf{y}||_p.
\]</span>
Where the power <span class="math inline">\(p\)</span> is a positive integer. This type of distance is also called
a <span class="math inline">\(p\)</span>-norm written as <span class="math inline">\(L^p\)</span>. Special values for <span class="math inline">\(p\)</span> are:</p>
<ul>
<li>
<span class="math inline">\(p = 1\)</span>: Manhattan distance</li>
<li>
<span class="math inline">\(p = 2\)</span>: Euclidean distance</li>
<li>
<span class="math inline">\(p = \infty\)</span>: Maximum norm (only the largest component distance counts)</li>
</ul>
<p>To avoid
one feature to dominate the distance calculation, scaled data is
typically used. We select the first 5 flowers for this example.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_sample</span> <span class="op">&lt;-</span> <span class="va">iris.scaled</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">iris_sample</span></span>
<span><span class="co">## # A tibble: 5 × 4</span></span>
<span><span class="co">##   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">## 1       -0.898      1.02          -1.34       -1.31</span></span>
<span><span class="co">## 2       -1.14      -0.132         -1.34       -1.31</span></span>
<span><span class="co">## 3       -1.38       0.327         -1.39       -1.31</span></span>
<span><span class="co">## 4       -1.50       0.0979        -1.28       -1.31</span></span>
<span><span class="co">## 5       -1.02       1.25          -1.34       -1.31</span></span></code></pre></div>
<p>Different types of Minkowsky distance matrices between the first 5
flowers can be calculated using <code>dist()</code>.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">iris_sample</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="co">##        1      2      3      4</span></span>
<span><span class="co">## 2 1.1723                     </span></span>
<span><span class="co">## 3 0.8428 0.5216              </span></span>
<span><span class="co">## 4 1.1000 0.4326 0.2829       </span></span>
<span><span class="co">## 5 0.2593 1.3819 0.9883 1.2460</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">iris_sample</span>, method <span class="op">=</span> <span class="st">"manhattan"</span><span class="op">)</span></span>
<span><span class="co">##        1      2      3      4</span></span>
<span><span class="co">## 2 1.3887                     </span></span>
<span><span class="co">## 3 1.2280 0.7570              </span></span>
<span><span class="co">## 4 1.5782 0.6484 0.4635       </span></span>
<span><span class="co">## 5 0.3502 1.4973 1.3367 1.6868</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">iris_sample</span>, method <span class="op">=</span> <span class="st">"maximum"</span><span class="op">)</span></span>
<span><span class="co">##        1      2      3      4</span></span>
<span><span class="co">## 2 1.1471                     </span></span>
<span><span class="co">## 3 0.6883 0.4589              </span></span>
<span><span class="co">## 4 0.9177 0.3623 0.2294       </span></span>
<span><span class="co">## 5 0.2294 1.3766 0.9177 1.1471</span></span></code></pre></div>
<p>We see that only the lower triangle of the distance matrices are stored
(note that rows start with row 2).</p>
</div>
<div id="distances-for-binary-data" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> Distances for Binary Data<a class="anchor" aria-label="anchor" href="#distances-for-binary-data"><i class="fas fa-link"></i></a>
</h3>
<p>Binary data can be encodes as <code>0</code> and <code>1</code> (numeric) or <code>TRUE</code> and
<code>FALSE</code> (logical).</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">b</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">## [1,]    0    0    0    1    1    1    1    0    0     1</span></span>
<span><span class="co">## [2,]    0    0    1    1    1    0    0    1    0     0</span></span>
<span><span class="va">b_logical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">b</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, <span class="va">as.logical</span><span class="op">)</span></span>
<span><span class="va">b_logical</span></span>
<span><span class="co">##       [,1]  [,2]  [,3] [,4] [,5]  [,6]  [,7]  [,8]  [,9]</span></span>
<span><span class="co">## [1,] FALSE FALSE FALSE TRUE TRUE  TRUE  TRUE FALSE FALSE</span></span>
<span><span class="co">## [2,] FALSE FALSE  TRUE TRUE TRUE FALSE FALSE  TRUE FALSE</span></span>
<span><span class="co">##      [,10]</span></span>
<span><span class="co">## [1,]  TRUE</span></span>
<span><span class="co">## [2,] FALSE</span></span></code></pre></div>
<div id="hamming-distance" class="section level4" number="2.4.2.1">
<h4>
<span class="header-section-number">2.4.2.1</span> Hamming Distance<a class="anchor" aria-label="anchor" href="#hamming-distance"><i class="fas fa-link"></i></a>
</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Hamming_distance">Hamming distance</a>
is the number of mismatches between two binary vectors. For 0-1 data
this is equivalent to the Manhattan distance and also the squared
Euclidean distance.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">b</span>, method <span class="op">=</span> <span class="st">"manhattan"</span><span class="op">)</span></span>
<span><span class="co">##   1</span></span>
<span><span class="co">## 2 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">b</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">##   1</span></span>
<span><span class="co">## 2 5</span></span></code></pre></div>
</div>
<div id="jaccard-index" class="section level4" number="2.4.2.2">
<h4>
<span class="header-section-number">2.4.2.2</span> Jaccard Index<a class="anchor" aria-label="anchor" href="#jaccard-index"><i class="fas fa-link"></i></a>
</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard index</a> is a
similarity measure that focuses on matching 1s. R converts the
similarity into a dissimilarity using <span class="math inline">\(d_{J} = 1 - s_{J}\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">b</span>, method <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span><span class="co">##        1</span></span>
<span><span class="co">## 2 0.7143</span></span></code></pre></div>
</div>
</div>
<div id="distances-for-mixed-data" class="section level3" number="2.4.3">
<h3>
<span class="header-section-number">2.4.3</span> Distances for Mixed Data<a class="anchor" aria-label="anchor" href="#distances-for-mixed-data"><i class="fas fa-link"></i></a>
</h3>
<p>Most distance measures work only on numeric data. Often, we have a
mixture of numbers and nominal or ordinal features like this data:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">people</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>      <span class="fl">160</span>,    <span class="fl">185</span>,    <span class="fl">170</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>       <span class="fl">52</span>,     <span class="fl">90</span>,     <span class="fl">75</span><span class="op">)</span>,</span>
<span>  sex    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"male"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">people</span></span>
<span><span class="co">## # A tibble: 3 × 3</span></span>
<span><span class="co">##   height weight sex   </span></span>
<span><span class="co">##    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; </span></span>
<span><span class="co">## 1    160     52 female</span></span>
<span><span class="co">## 2    185     90 male  </span></span>
<span><span class="co">## 3    170     75 male</span></span></code></pre></div>
<p>It is important that nominal features are stored as factors and not
character (<code>&lt;chr&gt;</code>).</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">people</span> <span class="op">&lt;-</span> <span class="va">people</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="va">factor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">people</span></span>
<span><span class="co">## # A tibble: 3 × 3</span></span>
<span><span class="co">##   height weight sex   </span></span>
<span><span class="co">##    &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; </span></span>
<span><span class="co">## 1    160     52 female</span></span>
<span><span class="co">## 2    185     90 male  </span></span>
<span><span class="co">## 3    170     75 male</span></span></code></pre></div>
<div id="gowers-coefficient" class="section level4" number="2.4.3.1">
<h4>
<span class="header-section-number">2.4.3.1</span> Gower’s Coefficient<a class="anchor" aria-label="anchor" href="#gowers-coefficient"><i class="fas fa-link"></i></a>
</h4>
<p>The Gower’s coefficient of similarity works with mixed data by
calculating the appropriate similarity for each feature and then
aggregating them into a single measure. The package <code>proxy</code> implements
Gower’s coefficient converted into a distance.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'proxy'</span></span>
<span><span class="co">## The following object is masked from 'package:Matrix':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     as.matrix</span></span>
<span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     as.dist, dist</span></span>
<span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     as.matrix</span></span>
<span><span class="va">d_Gower</span> <span class="op">&lt;-</span> <span class="fu">dist</span><span class="op">(</span><span class="va">people</span>, method <span class="op">=</span> <span class="st">"Gower"</span><span class="op">)</span></span>
<span><span class="va">d_Gower</span></span>
<span><span class="co">##        1      2</span></span>
<span><span class="co">## 2 1.0000       </span></span>
<span><span class="co">## 3 0.6684 0.3316</span></span></code></pre></div>
<p>Gower’s coefficient calculation implicitly scales the data because it
calculates distances on each feature individually, so there is no need
to scale the data first.</p>
</div>
<div id="using-euclidean-distance-with-mixed-data" class="section level4" number="2.4.3.2">
<h4>
<span class="header-section-number">2.4.3.2</span> Using Euclidean Distance with Mixed Data<a class="anchor" aria-label="anchor" href="#using-euclidean-distance-with-mixed-data"><i class="fas fa-link"></i></a>
</h4>
<p>Sometimes methods (e.g., k-means) can only use Euclidean distance. In
this case, nominal features can be converted into 0-1 dummy variables.
After scaling, Euclidean distance will result in a usable distance
measure.</p>
<p>We use package <code>caret</code> to create dummy variables.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="co">## Loading required package: lattice</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'caret'</span></span>
<span><span class="co">## The following object is masked from 'package:purrr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     lift</span></span>
<span><span class="va">data_dummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/dummyVars.html">dummyVars</a></span><span class="op">(</span><span class="op">~</span><span class="va">.</span>, <span class="va">people</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">people</span><span class="op">)</span></span>
<span><span class="va">data_dummy</span></span>
<span><span class="co">##   height weight sex.female sex.male</span></span>
<span><span class="co">## 1    160     52          1        0</span></span>
<span><span class="co">## 2    185     90          0        1</span></span>
<span><span class="co">## 3    170     75          0        1</span></span></code></pre></div>
<p>Note that feature sex has now two columns. If we want that height,
weight and sex have the same influence on the distance measure, then we
need to weight the sex columns by 1/2 after scaling.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                        ncol <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                        nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data_dummy</span><span class="op">)</span>, </span>
<span>                        byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data_dummy_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">data_dummy</span><span class="op">)</span> <span class="op">*</span> <span class="va">weight_matrix</span></span>
<span></span>
<span><span class="va">d_dummy</span> <span class="op">&lt;-</span> <span class="fu">dist</span><span class="op">(</span><span class="va">data_dummy_scaled</span><span class="op">)</span></span>
<span><span class="va">d_dummy</span></span>
<span><span class="co">##       1     2</span></span>
<span><span class="co">## 2 3.064      </span></span>
<span><span class="co">## 3 1.891 1.427</span></span></code></pre></div>
<p>The distance using dummy variables is consistent with Gower’s distance.
However, note that Gower’s distance is scaled between 0 and 1 while the
Euclidean distance is not.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">d_dummy</span>, <span class="va">d_Gower</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">d_dummy</span>, y <span class="op">=</span> <span class="va">d_Gower</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## Don't know how to automatically pick scale for object of</span></span>
<span><span class="co">## type &lt;dist&gt;. Defaulting to continuous.</span></span>
<span><span class="co">## Don't know how to automatically pick scale for object of</span></span>
<span><span class="co">## type &lt;dist&gt;. Defaulting to continuous.</span></span>
<span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="R-Companion-Data-Mining_files/figure-html/unnamed-chunk-82-1.png" width="672"></div>
</div>
</div>
<div id="more-proximity-measures" class="section level3" number="2.4.4">
<h3>
<span class="header-section-number">2.4.4</span> More Proximity Measures<a class="anchor" aria-label="anchor" href="#more-proximity-measures"><i class="fas fa-link"></i></a>
</h3>
<p>The package <code>proxy</code> implements a wide array of proximity measures
(similarity measures are converted into distances).</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span></span>
<span><span class="va">pr_DB</span><span class="op">$</span><span class="fu">get_entry_names</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##  [1] "Jaccard"         "Kulczynski1"     "Kulczynski2"    </span></span>
<span><span class="co">##  [4] "Mountford"       "Fager"           "Russel"         </span></span>
<span><span class="co">##  [7] "simple matching" "Hamman"          "Faith"          </span></span>
<span><span class="co">## [10] "Tanimoto"        "Dice"            "Phi"            </span></span>
<span><span class="co">## [13] "Stiles"          "Michael"         "Mozley"         </span></span>
<span><span class="co">## [16] "Yule"            "Yule2"           "Ochiai"         </span></span>
<span><span class="co">## [19] "Simpson"         "Braun-Blanquet"  "cosine"         </span></span>
<span><span class="co">## [22] "angular"         "eJaccard"        "eDice"          </span></span>
<span><span class="co">## [25] "correlation"     "Chi-squared"     "Phi-squared"    </span></span>
<span><span class="co">## [28] "Tschuprow"       "Cramer"          "Pearson"        </span></span>
<span><span class="co">## [31] "Gower"           "Euclidean"       "Mahalanobis"    </span></span>
<span><span class="co">## [34] "Bhjattacharyya"  "Manhattan"       "supremum"       </span></span>
<span><span class="co">## [37] "Minkowski"       "Canberra"        "Wave"           </span></span>
<span><span class="co">## [40] "divergence"      "Kullback"        "Bray"           </span></span>
<span><span class="co">## [43] "Soergel"         "Levenshtein"     "Podani"         </span></span>
<span><span class="co">## [46] "Chord"           "Geodesic"        "Whittaker"      </span></span>
<span><span class="co">## [49] "Hellinger"       "fJaccard"</span></span></code></pre></div>
<p>Note that loading the package <code>proxy</code> overwrites the default <code>dist()</code> function
in R.
You can specify which dist function to use by specifying the package in
the call. For example <code><a href="https://rdrr.io/r/stats/dist.html">stats::dist()</a></code> calls the default function in R
(the package <code>stats</code> is part of R) while <code>proxy::dist()</code> calls the
version in the package <code>proxy</code>.</p>
</div>
</div>
<div id="exercises" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Exercises*<a class="anchor" aria-label="anchor" href="#exercises"><i class="fas fa-link"></i></a>
</h2>
<p>The R package <strong>palmerpenguins</strong> contains measurements for penguin of different
species from the Palmer Archipelago, Antarctica. Install the package.
It provides a CSV file which can be read in the following way:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://allisonhorst.github.io/palmerpenguins/">"palmerpenguins"</a></span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'palmerpenguins'</span></span>
<span><span class="co">## The following objects are masked from 'package:datasets':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     penguins, penguins_raw</span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://allisonhorst.github.io/palmerpenguins/reference/path_to_file.html">path_to_file</a></span><span class="op">(</span><span class="st">"penguins.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rows: 344 Columns: 8</span></span>
<span><span class="co">## ── Column specification ────────────────────────────────────</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## chr (3): species, island, sex</span></span>
<span><span class="co">## dbl (5): bill_length_mm, bill_depth_mm, flipper_length_m...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 8</span></span>
<span><span class="co">##   species island    bill_length_mm bill_depth_mm</span></span>
<span><span class="co">##   &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">## 1 Adelie  Torgersen           39.1          18.7</span></span>
<span><span class="co">## 2 Adelie  Torgersen           39.5          17.4</span></span>
<span><span class="co">## 3 Adelie  Torgersen           40.3          18  </span></span>
<span><span class="co">## 4 Adelie  Torgersen           NA            NA  </span></span>
<span><span class="co">## 5 Adelie  Torgersen           36.7          19.3</span></span>
<span><span class="co">## 6 Adelie  Torgersen           39.3          20.6</span></span>
<span><span class="co">## # ℹ 4 more variables: flipper_length_mm &lt;dbl&gt;,</span></span>
<span><span class="co">## #   body_mass_g &lt;dbl&gt;, sex &lt;chr&gt;, year &lt;dbl&gt;</span></span></code></pre></div>
<p>Create in RStudio a new R Markdown document.
Apply the code in the sections of this chapter to the data set to answer the
following questions.</p>
<ol style="list-style-type: decimal">
<li>What is the scale of measurement for each column?</li>
<li>Are there missing values in the data? How much data is missing?</li>
<li>Compute and discuss basic statistics.</li>
<li>Calculate the similarity between five randomly chosen penguins. Do you need to scale the data?
Discuss what measures are appropriate for the data.</li>
</ol>
<p>Make sure your markdown document contains now a well formatted report.
Use the <code>Knit</code> button to create a HTML document.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction.html"><span class="header-section-number">1</span> Introduction</a></div>
<div class="next"><a href="classification-basic-concepts.html"><span class="header-section-number">3</span> Classification: Basic Concepts</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#data"><span class="header-section-number">2</span> Data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#packages-used-in-this-chapter">Packages Used in this Chapter</a></li></ul>
</li>
<li>
<a class="nav-link" href="#types-of-data"><span class="header-section-number">2.1</span> Types of Data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#attributes-and-measurement"><span class="header-section-number">2.1.1</span> Attributes and Measurement</a></li>
<li><a class="nav-link" href="#the-iris-dataset"><span class="header-section-number">2.1.2</span> The Iris Dataset</a></li>
</ul>
</li>
<li><a class="nav-link" href="#data-quality"><span class="header-section-number">2.2</span> Data Quality</a></li>
<li>
<a class="nav-link" href="#data-preprocessing"><span class="header-section-number">2.3</span> Data Preprocessing</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#aggregation"><span class="header-section-number">2.3.1</span> Aggregation</a></li>
<li><a class="nav-link" href="#sampling"><span class="header-section-number">2.3.2</span> Sampling</a></li>
<li><a class="nav-link" href="#dimensionality-reduction"><span class="header-section-number">2.3.3</span> Dimensionality Reduction</a></li>
<li><a class="nav-link" href="#feature-subset-selection"><span class="header-section-number">2.3.4</span> Feature Subset Selection</a></li>
<li><a class="nav-link" href="#discretization"><span class="header-section-number">2.3.5</span> Discretization</a></li>
<li><a class="nav-link" href="#variable-transformation-standardization"><span class="header-section-number">2.3.6</span> Variable Transformation: Standardization</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#measures-of-similarity-and-dissimilarity"><span class="header-section-number">2.4</span> Measures of Similarity and Dissimilarity</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#minkowsky-distances"><span class="header-section-number">2.4.1</span> Minkowsky Distances</a></li>
<li><a class="nav-link" href="#distances-for-binary-data"><span class="header-section-number">2.4.2</span> Distances for Binary Data</a></li>
<li><a class="nav-link" href="#distances-for-mixed-data"><span class="header-section-number">2.4.3</span> Distances for Mixed Data</a></li>
<li><a class="nav-link" href="#more-proximity-measures"><span class="header-section-number">2.4.4</span> More Proximity Measures</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exercises"><span class="header-section-number">2.5</span> Exercises*</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mhahsler/Introduction_to_Data_Mining_R_Examples/blob/master/book_src/02_data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mhahsler/Introduction_to_Data_Mining_R_Examples/edit/master/book_src/02_data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>An R Companion for Introduction to Data Mining</strong>" was written by Michael Hahsler. It was last built on 2025-04-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
